<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Junta Calificadora de Méritos y Disciplina - Nivel Secundario</title>
    
    <!-- Preload de recursos -->
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap" as="style">
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" as="style">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    
    <!-- Estilos -->
    <style>
        /* ============ VARIABLES Y RESET ============ */
        :root {
            --color-primario: #004085;
            --color-secundario: #0056b3;
            --color-acento: #007bff;
            --color-texto: #333;
            --color-texto-claro: #666;
            --color-fondo: #eef2f7;
            --color-fondo-secundario: #fff;
            --sombra-box: 0 8px 20px rgba(0, 0, 0, 0.15);
            --sombra-boton: 0 4px 8px rgba(0, 123, 255, 0.2);
            --transicion-rapida: all 0.3s ease;
            --radio-borde: 8px;
            --min-tap-size: 48px; /* Tamaño mínimo para áreas táctiles */
        }
            /* Ajustes específicos para Samsung Internet */
        .samsung-browser .button {
            -webkit-tap-highlight-color: rgba(0,0,0,0.1);
        }
        
        .samsung-browser nav ul li a {
            padding: 15px 20px; /* Áreas más grandes para toques */
        }
        
        /* Mejoras para WebView */
        :root.webview .container {
            padding-bottom: constant(safe-area-inset-bottom); /* Para iPhone */
            padding-bottom: env(safe-area-inset-bottom);
        }
        
        {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Roboto', Arial, sans-serif;
            line-height: 1.6;
            background-color: var(--color-fondo);
            color: var(--color-texto);
            overflow-x: hidden;
        }
        
        /* ============ ESTRUCTURA PRINCIPAL ============ */
        .container {
            width: 90%;
            max-width: 1200px;
            margin: 20px auto 30px; /* Espacio normal sin banner */
            background: var(--color-fondo-secundario);
            padding: 15px 30px 30px;
            box-shadow: var(--sombra-box);
            border-radius: var(--radio-borde);
        }

        /* Versión con banner activo */
        .container.with-banner {
            margin-top: 70px; /* Espacio adicional para el banner */
        }
        .content-section {
            display: none;
            padding: 20px 0;
            margin-bottom: 30px;
            border-bottom: 1px dashed #e0e7ed;
        }
        
        #inicio {
            display: block;
            padding-top: 0;
            margin-top: 0;
        }
        /* Noticias Dinámicas */
        .news-item {
            background-color: #f9f9f9;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            text-align: left;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .news-item .news-content {
            margin-bottom: 15px;
        }
        
        .news-item .news-content p {
            margin: 0 0 10px 0;
            line-height: 1.8;
        }
        
        .news-item .news-list {
            list-style: disc;
            padding-left: 20px;
            margin: 10px 0;
        }
        
        .news-item .news-list li {
            margin-bottom: 8px;
        }
        
        .news-item .inline-link {
            color: var(--color-acento, #007bff); /* Cambia #007bff por tu color de acento */
            text-decoration: underline;
            font-weight: 500;
        }
        
        .news-item .inline-link:hover {
            color: var(--color-secundario, #0056b3); /* Cambia #0056b3 por tu color secundario */
        }
        .news-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
    
        .news-item h4 {
            color: #2c3e50;
            margin-top: 0;
            margin-bottom: 10px;
            font-size: 1.4em;
            border-bottom: 1px solid #eee;
            padding-bottom: 8px;
        }
    
        .news-item .news-date {
            display: block;
            font-size: 0.9em;
            color: #777;
            margin-bottom: 10px;
        }
    
        .news-item p {
            color: #555;
            margin-bottom: 15px;
        }
    
        .news-item .read-more {
            display: inline-block;
            color: #3498db;
            text-decoration: none;
            font-weight: bold;
            transition: color 0.3s ease;
        }
    
        .news-item .read-more:hover {
            color: #2980b9;
            text-decoration: underline;
        }
        /* ============ TIPOGRAFÍA ============ */
        h1, h2, h3, h4 {
            color: var(--color-primario);
            margin-bottom: 25px;
        }
        
        h1 {
            font-size: 2.8em;
            font-weight: 700;
            margin-top: 0;
            line-height: 1.2;
            text-align: center;
        }
        
        h2 {
            font-size: 2.2em;
            font-weight: 500;
            border-bottom: 2px solid #d0dae6;
            padding-bottom: 10px;
            margin-top: 5px;
            text-align: center;
        }
        
        h3 {
            font-size: 1.6em;
            font-weight: 400;
            text-align: left;
            border-bottom: 1px solid #d0dae6;
            padding-bottom: 8px;
            margin-bottom: 20px;
        }
        
        h3 small {
            display: block;
            font-size: 0.7em;
            color: var(--color-texto-claro);
            margin-top: 5px;
            font-weight: 300;
        }
        
        h4 {
            font-size: 1.3em;
            font-weight: 500;
            color: var(--color-acento);
            margin-bottom: 15px;
            margin-top: 25px;
        }
        
        p {
            font-size: 1.1em;
            line-height: 1.8;
            margin-bottom: 15px;
            text-align: justify;
        }
        
        /* ============ HEADER Y NAVEGACIÓN ============ */
        header {
            background: linear-gradient(to right, var(--color-primario), var(--color-secundario));
            color: white;
            padding: 10px 0;
            position: sticky;
            top: 0;
            width: 100%;
            z-index: 1000;
            box-shadow: 0 1px 5px rgba(0, 0, 0, 0.1);
        }
        
        .header-content {
            display: flex;
            justify-content: flex-start; /* Cambiado de space-between a flex-start */
            align-items: center;
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
            position: relative;
            gap: 30px; /* Espacio entre logo y navegación */
            padding-left: 15px; /* Añade padding a la izquierda */
            padding-right: 15px; /* Añadido para balance */
        }
        
        .logo img {
            max-height: 70px;
            width: auto;
            flex-shrink: 0; /* Evita que el logo se reduzca */
            margin-right: auto; /* Empuja el menú hacia la derecha */
            
        }
        
        
        /* Menú principal */
        nav ul {
            list-style: none;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: flex-start; /* Alinear a la izquierda */
            gap: 15px; /* Reducir espacio entre items */
            flex-grow: 1; /* Permitir que ocupe espacio disponible */
           /* flex-wrap: wrap; /* Permite que los items pasen a nueva línea si no caben */
        }
        
        nav ul li a {
            color: #ffffff;
            font-weight: 500;
            font-size: 1em;
            text-decoration: none;
            transition: var(--transicion-rapida);
            padding: 12px 15px;
            border-radius: var(--radio-borde);
            display: inline-flex;
            align-items: center;
            white-space: nowrap; /* Evita que el texto se parta */
        }
        
        nav ul li a i {
            margin-right: 8px;
            min-width: 18px;
            text-align: center;
        }
        
        nav ul li a:hover,
        nav ul li a:focus {
            background-color: rgba(255, 255, 255, 0.15);
            color: #a7d9ff;
        }
        
        .active-nav-link {
            color: #a7d9ff !important;
            font-weight: 700;
        }
        
        /* Menú móvil */
        .menu-toggle {
            display: none;
            flex-direction: column;
            justify-content: space-between;
            width: 30px;
            height: 20px;
            cursor: pointer;
            z-index: 1001;
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            background: transparent;
            border: none;
        }
        
        .menu-toggle .bar {
            width: 100%;
            height: 4px;
            background-color: white;
            border-radius: 5px;
            transition: var(--transicion-rapida);
            transform-origin: center;
            box-shadow: 0 0 2px rgba(0, 0, 0, 0.7);
        }
        
        .menu-toggle.active .bar:nth-child(1) {
            transform: rotate(45deg) translateY(7px);
        }
        
        .menu-toggle.active .bar:nth-child(2) {
            opacity: 0;
        }
        
        .menu-toggle.active .bar:nth-child(3) {
            transform: rotate(-45deg) translateY(-7px);
        }
        
        /* ============ COMPONENTES REUTILIZABLES ============ */
        /* Botones */
        .button {
            background-color: var(--color-acento);
            color: white;
            min-width: var(--min-tap-size);
            min-height: var(--min-tap-size);
            padding: 12px 25px;
            border: none;
            border-radius: var(--radio-borde);
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 600;
            transition: var(--transicion-rapida);
            box-shadow: var(--sombra-boton);
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            touch-action: manipulation; /* Mejora la respuesta táctil */
        }
        
        .button:hover {
            background-color: var(--color-secundario);
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 123, 255, 0.3);
        }
        
        .quick-access-buttons {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 20px;
            margin-top: 30px;
            margin-bottom: 40px;
        }
        
        .quick-access-buttons .button {
            min-width: 200px;
        }
        .info-message {
            background-color: #e7f4ff;
            border-left: 4px solid #007bff;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 4px;
            font-size: 0.95em;
        }
        
        .info-message i {
            color: #007bff;
            margin-right: 10px;
        }
        .welcome-text {
            font-size: 1.1em;
            color: var(--color-texto);
            margin-bottom: 20px;
            line-height: 1.6;
            border-left: 3px solid var(--color-acento);
            padding-left: 15px;
            font-style: italic;
        }
      /* Banner de celebración */
       .system-notification-banner {
            background: linear-gradient(135deg, #28a745 0%, #5cb85c 100%);
            color: white;
            padding: 12px 15px;
            margin: 0 auto;
            width: 90%;
            max-width: 1200px;
            border-radius: 8px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            position: relative;
            z-index: 999;
        }
        
        .notification-content {
            display: flex;
            align-items: center;
            gap: 12px;
            justify-content: center;
            text-align: left;
        }
        
        .notification-content i {
            font-size: 1.8em;
            color: #fff;
            min-width: 30px;
        }
        
        .notification-content strong {
            font-weight: 700;
            font-size: 1.1em;
            display: block;
            margin-bottom: 2px;
        }
        
        .notification-content span {
            font-size: 0.95em;
            opacity: 0.95;
        }
        
        .close-banner {
            position: absolute;
            right: 12px;
            background: transparent;
            border: none;
            color: white;
            font-size: 1.5em;
            cursor: pointer;
            top: 50%;
            transform: translateY(-50%);
        }
        
        @keyframes pulse {
            0% { transform: scale(1); box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
            100% { transform: scale(1.01); box-shadow: 0 6px 20px rgba(0,0,0,0.15); }
        }
            
     /* Lista de características mejorada (NUEVO) */
        .lead-text {
            font-size: 1.2em;
            font-weight: 600;
            color: var(--color-primario);
            margin: 20px 0 15px;
        }
        
        .feature-list {
            list-style: none;
            margin: 0 0 25px 0;
            padding: 0;
        }
        
        .feature-list li {
            padding: 8px 0;
            position: relative;
            padding-left: 30px;
            line-height: 1.5;
        }
        
        .feature-list i {
            color: var(--color-acento);
            position: absolute;
            left: 0;
            top: 10px;
        }
        .sub-feature-list {
            list-style: none;
            margin: 8px 0 0 15px;
            padding: 0;
        }
        
        .sub-feature-list li {
            padding: 4px 0;
            position: relative;
            padding-left: 25px;
            font-size: 0.95em;
            color: var(--color-texto-claro);
        }
        
        .sub-feature-list i {
            color: var(--color-secundario);
            position: absolute;
            left: 0;
            top: 6px;
            font-size: 0.8em;
        }
   /* Sistema de pestañas */
        .tabs-container {
            margin-top: 15px;
        }
        
        .tabs {
            display: flex;
            border-bottom: 1px solid #ddd;
            margin-bottom: 15px;
        }
        
        .tab-button {
            padding: 10px 20px;
            background: none;
            border: none;
            border-bottom: 3px solid transparent;
            cursor: pointer;
            font-weight: 600;
            color: var(--color-texto-claro);
            transition: all 0.3s ease;
        }
        
        .tab-button.active {
            color: var(--color-primario);
            border-bottom-color: var(--color-acento);
        }
        
        .tab-content {
            display: none;
            padding: 15px 0;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .year-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .small-button {
            padding: 8px 15px;
            font-size: 0.9em;
        }
        /* Grupos de búsqueda */
        .search-group {
            margin-bottom: 40px;
            padding: 25px;
            border: 1px solid #dbe2ea;
            border-radius: var(--radio-borde);
            background-color: #fcfdff;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }
        
        .search-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #dbe2ea;
            border-radius: var(--radio-borde);
            background-color: #f7f9fc;
            box-shadow: inset 0 1px 4px rgba(0, 0, 0, 0.07);
        }
        
        .search-section:last-of-type {
            margin-bottom: 0;
        }
        
        .search-section label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: #555;
        }
        
        .search-section input[type="text"],
        .search-section select {
            width: 100%;
            padding: 12px;
            margin-bottom: 15px;
            border: 1px solid #c2d1e2;
            border-radius: var(--radio-borde);
            font-size: 1em;
        }
        
        /* Resultados */
        .results-container {
            margin-top: 30px;
            border-top: 1px solid #e0e7ed;
            padding-top: 25px;
        }
        
        .results-table-container {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }
        
        .results-table {
            table-layout: fixed; /* Para control exacto del ancho */
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            border-radius: var(--radio-borde);
            overflow: hidden;
            display: block;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            white-space: nowrap;
        }
        .results-table th:nth-child(1),
        .results-table td:nth-child(1) {
            width: 30%; /* Ancho reducido para la columna de título */
        }
        
        .results-table th:nth-child(2),
        .results-table td:nth-child(2) {
            width: 40%; /* Más espacio para el espacio curricular */
        }
        
        .results-table th:nth-child(3),
        .results-table td:nth-child(3),
        .results-table th:nth-child(4),
        .results-table td:nth-child(4) {
            width: 15%; /* Columnas derechas más estrechas */
            text-align: center;
        }
        
        /* Estilo para títulos repetidos */
        .repeated-title {
            color: #666;
            font-size: 0.9em;
            font-style: italic;
        }
        
        .results-table th, 
        .results-table td {
            border: 1px solid #dee2e6;
            padding: 8px 5px;
            font-size: 0.85em;
            text-align: left;
            white-space: normal;
        }
        
        .results-table th {
            background-color: var(--color-acento);
            color: white;
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.9em;
            white-space: normal;
            line-height: 1.3;
            padding: 8px 5px;
        }
        .results-table th small {
            display: block;
            font-size: 0.7em;
            font-weight: normal;
            opacity: 0.8;
        }
        /* Columnas estrechas */
        .narrow-column {
            width: 80px; /* Ancho fijo para columnas de código/incumbencia */
            max-width: 80px;
            word-break: break-word;
            text-align: center;
        }
        
        .results-table tr:nth-child(even) {
            background-color: #f2f7fb;
        }
        
        .results-table tr:hover {
            background-color: #e9f2fa;
        }
        
        .results-table tr.highlighted-row {
            background-color: #e6ffe6;
            border-left: 5px solid #28a745;
        }
        
        .results-table td .clickable-title {
            cursor: pointer;
            text-decoration: none;
            color: var(--color-primario);
            font-weight: 500;
            transition: text-decoration 0.2s ease, color 0.2s ease;
        }
        
        .results-table td .clickable-title:hover {
            text-decoration: underline;
            color: var(--color-acento);
        }
        
        .no-results {
            text-align: center;
            color: #777;
            padding: 20px;
            font-style: italic;
        }
        
        /* Componentes especiales */
        .quick-tutorial {
            background-color: #e6f7ff;
            border-left: 5px solid var(--color-acento);
            padding: 20px;
            margin: 25px 0;
            border-radius: var(--radio-borde);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            font-size: 1.05em;
            line-height: 1.6;
        }
        
        .quick-tutorial ul {
            list-style: none;
            padding-left: 0;
        }
        
        .quick-tutorial ul li {
            margin-bottom: 10px;
            padding-left: 25px;
            position: relative;
            color: #444;
        }
        
        .quick-tutorial ul li::before {
            content: "\f058";
            font-family: "Font Awesome 5 Free";
            font-weight: 900;
            position: absolute;
            left: 0;
            top: 0;
            color: #28a745;
        }
                    
        /* Estilos para comunicado oficial */
        .official-communique {
            background-color: white;
            border-radius: var(--radio-borde);
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
            border-top: 3px solid var(--color-primario);
        }
        
        .communique-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            font-size: 0.9em;
            color: var(--color-texto-claro);
        }
        
        .communique-content h4 {
            color: var(--color-primario);
            margin: 20px 0 10px;
        }
        
        .communique-content ul {
            padding-left: 20px;
        }
        
        .communique-content ul li {
            margin-bottom: 8px;
        }
        
        address {
            font-style: normal;
            background: #f5f5f5;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
        
        .communique-recommendations {
            background: #fff8e1;
            padding: 15px;
            border-radius: 4px;
            border-left: 4px solid #ffc107;
            margin-top: 20px;
        }
        
        /* Iframes */
        .news-iframe-container,
        .map-container {
            position: relative;
            overflow: hidden;
            height: 0;
            margin-top: 20px;
            border-radius: var(--radio-borde);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            background-color: #f0f0f0;
        }
        
        .news-iframe-container {
            padding-top: 75%;
        }
        
        .map-container {
            padding-top: 56.25%;
        }
        
        .news-iframe-container iframe,
        .map-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
        }
        
        /* Footer */
        footer {
            text-align: center;
            padding: 25px;
            background-color: #343a40;
            color: white;
            margin-top: 40px;
            border-top: 5px solid var(--color-secundario);
            font-size: 0.9em;
        }
        
        /* ============ MEJORAS DE ACCESIBILIDAD Y FEEDBACK ============ */
        /* Botones uniformes (todos azules) */
        .search-section button {
            background-color: var(--color-acento);
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: var(--radio-borde);
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: var(--transicion-rapida);
            box-shadow: var(--sombra-boton);
            width: 100%;
        }
        
        .search-section button:hover {
            background-color: var(--color-secundario);
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 123, 255, 0.3);
        }
        
        /* Estados de focus para accesibilidad */
        button:focus, 
        input:focus, 
        select:focus,
        a:focus {
            outline: 3px solid var(--color-acento);
            outline-offset: 2px;
        }
        
        /* Indicadores de carga */
        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
            margin-left: 10px;
            vertical-align: middle;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Mejora para resultados vacíos */
        .no-results {
            padding: 30px;
            background-color: #f8f9fa;
            border-radius: var(--radio-borde);
            text-align: center;
            font-style: italic;
            color: var(--color-texto-claro);
            border: 1px dashed #dee2e6;
        }
        
        .no-results i {
            font-size: 2em;
            color: #adb5bd;
            margin-bottom: 15px;
            display: block;
        }

        /* Mejora para selects con ENTER */
        select {
            transition: all 0.3s ease;
        }
        
        select:focus {
            border-color: var(--color-acento);
            box-shadow: 0 0 0 2px rgba(0,123,255,0.25);
        }
        
        /* ============ RESPONSIVE DESIGN ============ */
        @media (max-width: 768px) {
            /* Header */
            header .header-content {
                padding: 0 15px;
            }
            
            header .logo img {
                max-height: 35px;
                margin-right: 10px;
                padding-left: 8px;
                padding-right: 8px;
            }

            .urgent-notification-banner {
                flex-wrap: wrap;
                padding: 10px 15px 25px;
                gap: 8px;
             }
    
          .urgent-notification-banner .button {
                margin-left: 0;
                margin-top: 5px;
            }
            
          .official-communique {
                padding: 15px;
            }
            
            .communique-header {
                flex-direction: column;
                gap: 5px;
            }
                  
            .menu-toggle {
                display: flex;
            }
            .repeated-title {
                font-size: 0.8em;
            }
            .results-table th, 
            .results-table td {
                padding: 6px 3px;
                font-size: 0.8em;
            }
            
            .narrow-column {
                width: 60px;
                max-width: 60px;
            }
            nav {
                transform: translateX(-100%);
                position: fixed;
                top: 0;
                left: -100%;
                width: 100%;
                height: 100%;
                background: linear-gradient(to bottom, var(--color-primario), #003366);
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
                transition: left 0.3s ease-in-out;
                z-index: 999;
            }
            
            nav.active {
                transform: translateX(0);
                left: 0;
            }
            
            nav ul {
                flex-direction: column;
                gap: 35px;
            }
            
            nav ul li a {
                padding: 15px 25px;
                font-size: 1.2em;
            }
            .welcome-text {
                font-size: 1em;
                padding-left: 10px;
                margin-bottom: 15px;
            }
             /* Ajustes para la lista de características */
            .lead-text {
                font-size: 1.1em;
            }
            
            .feature-list li {
                font-size: 0.95em;
                padding-left: 25px;
            }
            .sub-feature-list {
                margin-left: 10px;
            }
            
            .sub-feature-list li {
                padding-left: 20px;
                font-size: 0.85em;
            }
            .system-notification-banner {
                width: 95%;
                padding: 10px;
            }
            
            .notification-content {
                flex-wrap: wrap;
                justify-content: flex-start;
                gap: 8px;
            }
            
            .notification-content > div {
                flex: 1;
                min-width: 80%;
            }
             .tabs {
                flex-direction: column;
            }
            
            .tab-button {
                border-bottom: none;
                border-left: 3px solid transparent;
                text-align: left;
            }
            
            .tab-button.active {
                border-left-color: var(--color-acento);
            }
            
            .year-buttons {
                flex-direction: column;
            }
            
            .small-button {
                width: 100%;
            }
            /* Contenido */
            .container {
                margin: 15px auto 20px;
                padding: 10px 15px 20px;
                width: 95%;
                padding: 15px;
                margin-left: auto;
                margin-right: auto;
            }
            .container.with-banner {
                margin-top: 60px;
            }
            
            h1 {
                font-size: 1.8em;
                margin-bottom: 2px;
            }
            
            h2 {
                font-size: 1.2em;
                margin-top: 2px;
            }
            
            /* Botones */
            .quick-access-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .quick-access-buttons .button {
                width: 80%;
                min-width: unset;
            }
            
            /* Iframes */
            .news-iframe-container, 
            .map-container {
                padding-top: 120%;
            }
        }
        
        @media (max-width: 768px) and (orientation: landscape) {
            header {
                padding: 8px 0;
            }
            
            header .logo img {
                max-height: 30px;
            }
            
            header nav ul li a {
                font-size: 1.2em;
                padding: 5px 0;
            }
            
            .container {
                margin-top: 80px;
            }
        }
        
        /* Estilos para impresión */
        @media print {
            body {
                background-color: #fff;
                -webkit-print-color-adjust: exact;
            }
            
            .container, header, footer, .menu-toggle, .quick-access-buttons,
            .search-section label, .search-section input, .search-section select,
            .search-section button, h1, h2, h3 small, p, ul:not(.results-table),
            .news-iframe-container, .map-container, .search-group:not(.print-visible) {
                display: none !important;
            }
            
            .results-table-container {
                display: block !important;
                overflow-x: visible !important;
            }
            
            .results-table {
                width: 100% !important;
                border-collapse: collapse !important;
                margin-top: 0 !important;
                box-shadow: none !important;
                border-radius: 0 !important;
                display: table;
                white-space: normal;
            }
            
            .results-table th, .results-table td {
                border: 1px solid #000 !important;
                padding: 8px !important;
                color: #000 !important;
                background-color: #f0f0f0 !important;
            }
            
            .results-table th {
                background-color: #ddd !important;
            }
            
            .results-table tr:nth-child(even) {
                background-color: #f7f7f7 !important;
            }
            
            .results-table tr:hover {
                background-color: #f7f7f7 !important;
            }
            
            .results-table td .clickable-title {
                text-decoration: none !important;
                color: #000 !important;
                font-weight: normal !important;
                cursor: default !important;
            }
            
            .results-table tr.highlighted-row {
                background-color: #e0ffe0 !important;
                border-left: 5px solid #66bb6a !important;
            }
            
            .results-table strong {
                font-weight: bold !important;
                color: #000 !important;
            }
        }
        /* ===== MEJORAS PARA MÓVILES ===== */
        @media (max-width: 480px) {
            /* Ajustes para pantallas muy pequeñas */
            :root {
                --radio-borde: 6px;
            }
            
            h1 {
                font-size: 1.5em;
                margin-bottom: 5px;
            }
            
            h2 {
                font-size: 1.1em;
            }
            
            .container {
                width: 98%;
                padding: 10px;
                margin-top: 80px;
            }
            
            .quick-access-buttons .button {
                width: 100%;
                padding: 12px;
            }
            
            /* Mejorar tablas en móviles */
            .results-table th, 
            .results-table td {
                padding: 6px 3px;
                font-size: 0.75em;
            }
            
            /* Optimizar inputs */
            .search-section input[type="text"],
            .search-section select {
                padding: 10px;
                font-size: 0.9em;
            }
        }
        
        /* Optimización para tablets */
        @media (min-width: 481px) and (max-width: 768px) {
            .container {
                width: 95%;
            }
            
            .quick-access-buttons {
                flex-direction: row;
                flex-wrap: wrap;
            }
            
            .quick-access-buttons .button {
                min-width: calc(50% - 10px);
            }
        }
        @media (min-width: 1600px) {
            .header-content {
            max-width: 1400px; /* Permite más espacio para el menú */
        }
    
    nav ul {
        gap: 20px; /* Recupera un poco más de espacio entre items */
    }
}
    </style>
    
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-8M7TMMZ47B"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-8M7TMMZ47B');
    </script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>
    <header>
        <div class="header-content">
            <div class="logo">
                <img src="jcmyd-logo.png" alt="Logo Junta Calificadora de Méritos y Disciplina">
            </div>
            <button class="menu-toggle" id="mobile-menu" aria-label="Menú principal" aria-expanded="false" aria-controls="main-nav" aria-haspopup="true">
                <span class="bar" aria-hidden="true"></span>
                <span class="bar" aria-hidden="true"></span>
                <span class="bar" aria-hidden="true"></span>
            </button>
            <nav id="main-nav" role="navigation" aria-label="Menú principal">
                <ul>
                    <li><a href="#inicio"><i class="fas fa-home"></i> Inicio</a></li>
                    <li><a href="#sobre-nosotros"><i class="fas fa-users"></i> Sobre Nosotros</a></li>
                    <li><a href="#herramientas-consulta"><i class="fas fa-search"></i> Herramientas</a></li>
                    <li><a href="#normativas"><i class="fas fa-gavel"></i> Normativas</a></li>
                    <li><a href="#tramites"><i class="fas fa-file-signature"></i> Trámites</a></li>
                    <li><a href="#noticias"><i class="fas fa-newspaper"></i> Noticias</a></li>
                    <li><a href="#contacto"><i class="fas fa-envelope"></i> Contacto</a></li>
                </ul>
            </nav>
        </div>
    </header>
    </header>

        <!-- Banner de prórroga -->
       
        
        <div class="container">
            
       <section id="inicio" class="content-section">
            <h1>Junta Calificadora de Méritos y Disciplina</h1>
            <h2>Nivel Secundario y sus Modalidades</h2>
            
            <p class="welcome-text">
                Plataforma oficial de la Junta Calificadora de Méritos y Disciplina del Nivel Secundario y sus Modalidades. 
                Herramientas digitales para tu desarrollo docente.
            </p>
            
            <ul class="feature-list">
                <li><i class="fas fa-check-circle"></i> Verifica qué materias puedes dictar con tu título</li>
                <li><i class="fas fa-check-circle"></i> Encuentra colegios por ubicación o especialidad</li>
                <li><i class="fas fa-check-circle"></i> Accede a información para inscripciones, reinscripciones y trámites docentes:
                    <ul class="sub-feature-list">
                        <li><i class="fas fa-arrow-right"></i> Traslados y permutas</li>
                        <li><i class="fas fa-arrow-right"></i> Cuadros de ascensos</li>
                        <li><i class="fas fa-arrow-right"></i> Concursos abiertos</li>
                        <li><i class="fas fa-arrow-right"></i> Regularización de antecedentes</li>
                    </ul>
                </li>
            </ul>
        
            <div class="quick-access-buttons">
                <a href="#herramientas-consulta" class="button" onclick="showSection('herramientas-consulta');">
                    <i class="fas fa-search"></i> Comenzar Búsquedas
                </a>
                <a href="#tramites" class="button" onclick="showSection('tramites');">
                    <i class="fas fa-file-alt"></i> Ver Trámites
                </a>
            </div>
       </section>

        <section id="sobre-nosotros" class="content-section">
            <h2>Sobre Nosotros: Junta Calificadora de Méritos y Disciplina</h2>
            <p>La Junta Calificadora de Méritos y Disciplina de Nivel Secundario y sus Modalidades es un organismo permanente y desconcentrado del Ministerio de Educación, Cultura, Ciencia y Tecnología de la Provincia de Salta. Su misión es garantizar la transparencia, equidad y legalidad en la carrera docente, desde el ingreso hasta los ascensos y traslados.</p>
            <ul>
                <li>Estudiar y custodiar los legajos de antecedentes de todo el personal docente, efectuando su calificación general por orden de mérito.</li>
                <li>Formular la nómina de aspirantes para el ingreso, interinatos y suplencias en el nivel secundario y sus modalidades.</li>
                <li>Dictaminar en los pedidos de permutas, traslados y reincorporaciones, evaluando cada caso según la normativa vigente.</li>
                <li>Considerar las peticiones de permanencia en actividad, de acuerdo con las disposiciones de las leyes jubilatorias.</li>
                <li>Pronunciarse sobre las solicitudes de becas presentadas por el personal docente.</li>
                <li>Emitir dictámenes previos en casos de aplicación de sanciones disciplinarias, asegurando el debido proceso y el derecho a defensa.</li>
                <li>Dar amplia publicidad a las listas confeccionadas en base al mérito, relativas a ascensos, traslados, interinatos y suplencias, promoviendo la transparencia en los procesos.</li>
            </ul>
            <p>La Junta está integrada por diez miembros: seis elegidos por voto secreto y obligatorio del personal docente, tres designados por el Ministerio y uno propuesto por la asociación sindical con mayor representación en el nivel educativo correspondiente. Los miembros ejercen sus funciones por un período de cuatro años, con posibilidad de reelección por un período adicional.</p>
            <p>Comprometida con el fortalecimiento del sistema educativo provincial, la Junta actúa con independencia técnica y responsabilidad institucional, promoviendo prácticas justas y meritocráticas en beneficio de la comunidad educativa.</p>
        </section>

        <section id="herramientas-consulta" class="content-section">
            <h2>Herramientas de Consulta</h2>
            <p>Aquí encontrarás todas las herramientas de búsqueda para facilitarte el acceso a la información que necesitas. A continuación, te explicamos brevemente cada una:</p>

            <div class="quick-tutorial">
                <h4>Guía Rápida de Uso de Buscadores:</h4>
                <ul>
                    <li><strong>Buscador de Títulos y Espacios Curriculares:</strong> Ingresa tu título (o parte de él) para ver qué espacios curriculares puedes dictar. Haz clic en cualquier título de la tabla para ver solo sus incumbencias exactas.</li>
                    <li><strong>Buscador de Colegios por Espacio Curricular y Ubicación:</strong> Una vez que hayas buscado un título, selecciona un espacio curricular y un departamento para encontrar colegios que lo dictan (se muestran 7 al azar).</li>
                    <li><strong>Buscador por Orientación:</strong> Encuentra colegios secundarios según su orientación educativa (ej: Ciencias Naturales, Informática).</li>
                    <li><strong>Búsqueda por Localidad/Departamento:</strong> Busca colegios secundarios ingresando una localidad o departamento.</li>
                    <li><strong>Buscador por Categoría:</strong> Filtra colegios por su tipo: Secundario Común, EET o BSPA. Puedes combinar con filtros de departamento y localidad.</li>
                    <li><strong>Buscar Orientaciones por N° de Colegio:</strong> Si conoces el número de una Unidad Educativa, ingresarlo aquí te mostrará las orientaciones que ofrece.</li>
                </ul>
                <p>¡Esperamos que estas herramientas te sean de gran utilidad!</p>
            </div>

            <!-- Buscador para Docentes Ingresantes: Títulos y Espacios Curriculares -->
            <section class="search-group">
                <h3>Buscador de Títulos y Espacios Curriculares <small>(Ideal para docentes ingresantes)</small></h3>
                <p>Encuentra qué espacios curriculares puedes dictar con tu título. Las incumbencias responden al manual de competencias vigentes del Ministerio de Educación de Salta. **Puedes hacer clic en cualquier título de la tabla de resultados para filtrar y ver solo sus incumbencias exactas.**</p>
                <div class="search-section">
                    <label for="tituloInputIntegrado">1. Ingresa tu Título (o parte de él):</label>
                    <input type="text" id="tituloInputIntegrado" placeholder="Ej: Profesor de Historia" 
       autocapitalize="off" autocorrect="off" spellcheck="false">
                    <button onclick="buscarIncumbenciasIntegrado(event)" aria-label="Buscar espacios curriculares por título">Buscar Espacios Curriculares</button>

                    <div class="results-container">
                        <h3>Resultados de Incumbencias</h3>
                        <div id="incumbenciasResultsIntegrado">
                            <div class="results-table-container">
                                <p class="no-results"><i class="fas fa-search"></i> Aquí se mostrarán los espacios curriculares que puedes dictar.</p>
                            </div>
                        </div>
                        <button class="button mt-4" onclick="printTableResults('incumbenciasResultsIntegrado')">Imprimir Incumbencias</button>
                    </div>
                </div>
            </section>

            <!-- Buscador de Colegios por Espacio Curricular y Ubicación -->
            <section class="search-group">
                <h3>Buscador de Colegios por Espacio Curricular y Ubicación</h3>
                <p>Encuentra colegios que dictan un espacio curricular específico en un departamento. Puedes usar un espacio obtenido del buscador anterior o ingresar uno directamente.</p>
                <div class="search-section">
                    <label for="espacioCurricularSelect">2. Selecciona un Espacio Curricular:</label>
                    <select id="espacioCurricularSelect" disabled>
                        <option value="">-- Selecciona un espacio curricular --</option>
                    </select>

                    <label for="departamentoSelect">3. Selecciona un Departamento:</label>
                    <select id="departamentoSelect" disabled>
                        <option value="">-- Selecciona un departamento --</option>
                    </select>
                    <button onclick="buscarColegiosAleatoriosPorEspacio(event)" id="btnBuscarColegios" disabled aria-label="Buscar colegios por espacio curricular y departamento">Buscar Colegios (7 al azar)</button>

                    <div class="results-container">
                        <h3>Colegios Encontrados</h3>
                        <div id="colegiosPorEspacioResults">
                             <div class="results-table-container">
                                <p class="no-results"><i class="fas fa-school"></i> Aquí se mostrarán los colegios.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Otras Búsquedas de Colegios -->
            <section class="search-group">
                <h3>Otras Búsquedas de Colegios</h3>
                <p>Herramientas adicionales para encontrar colegios por diferentes criterios.</p>

                <!-- Búsqueda de Colegios por Orientación -->
                <div class="search-section">
                    <h4>Búsqueda por Orientación</h4>
                    <p>Encuentra colegios secundarios según su orientación educativa.</p>
                    <label for="orientacionInput">Buscar por Orientación:</label>
                    <input type="text" id="orientacionInput" placeholder="Ej: Ciencias Naturales, Informática, Humanidades"
       autocapitalize="off" autocorrect="off" spellcheck="false">
                    <button onclick="buscarOrientaciones(event)" aria-label="Buscar colegios por orientación educativa">Buscar Orientaciones</button>

                    <div class="results-container">
                        <h3>Resultados de Orientaciones</h3>
                        <div id="orientacionesResults">
                            <div class="results-table-container">
                                <p class="no-results"><i class="fas fa-compass"></i> No hay resultados para mostrar.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Búsqueda de Colegios por Localidad/Departamento -->
                <div class="search-section" id="colegios" style="margin-top: 20px;">
                    <h4>Búsqueda por Localidad/Departamento</h4>
                    <p>Encuentra colegios secundarios ingresando una localidad o departamento.</p>
                    <label for="localidadInput">Buscar por Localidad o Departamento:</label>
                   <input type="text" id="localidadInput" placeholder="Ej: Salta Capital, San Ramón de la Nueva Orán"
       autocapitalize="words" autocorrect="off" spellcheck="false">
                    <button id="btnBuscarColegiosLocalidad" onclick="buscarColegios(event)" aria-label="Buscar colegios por localidad o departamento">Buscar Colegios</button>

                    <div class="results-container">
                        <h3>Resultados de Colegios</h3>
                        <div id="colegiosResults">
                             <div class="results-table-container">
                                <p class="no-results"><i class="fas fa-map-marker-alt"></i> No hay resultados para mostrar.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Buscador por Categoría de Colegios -->
            <section class="search-group">
                <h3>Buscador por Categoría <small>Encuentra colegios por su tipo (Secundario Común, EET, BSPA).</small></h3>
                <p>Selecciona la categoría de colegio y opcionalmente filtra por departamento y/o localidad:</p>
                <div class="search-section">
                    <label for="categoriaColegioSelect">Categoría de Colegio:</label>
                    <select id="categoriaColegioSelect">
                        <option value="">Seleccione una categoría</option>
                        <option value="comun">Secundario Común</option>
                        <option value="eet">Esc. de Ed. Tec. EET</option>
                        <option value="bspa">BSPAS</option>
                    </select>
                </div>
                <div class="search-section">
                    <label for="categoriaDepartamentoSelect">Departamento:</label>
                    <select id="categoriaDepartamentoSelect">
                        <option value="">-- Todos los Departamentos --</option>
                    </select>
                </div>
                <div class="search-section">
                    <label for="categoriaLocalidadSelect">Localidad:</label>
                    <select id="categoriaLocalidadSelect" disabled>
                        <option value="">-- Todas las Localidades --</option>
                    </select>
                </div>
                <div class="search-section">
                    <button class="button" id="btnBuscarColegiosPorCategoria" onclick="buscarColegiosPorCategoria(event)" aria-label="Buscar colegios por categoría">Buscar por Categoría</button>
                </div>
                <div class="results-container">
                    <h3>Resultados por Categoría</h3>
                    <div id="colegiosPorCategoriaResults">
                        <div class="results-table-container">
                            <p class="no-results"><i class="fas fa-list"></i> Aquí se mostrarán los colegios por categoría, departamento y/o localidad.</p>
                        </div>
                    </div>
                    <button class="button" onclick="printTableResults('colegiosPorCategoriaResults')">Imprimir Colegios (Categoría)</button>
                </div>
            </section>

            <!-- Buscador de Orientaciones por Número de Colegio -->
            <section class="search-group">
                <h3>Buscar Orientaciones por N° de Colegio <small>Encuentra las orientaciones ofrecidas por una unidad educativa específica.</small></h3>
                <p>Ingrese el número de la Unidad Educativa para ver sus orientaciones:</p>
                <div class="search-section">
                    <label for="colegioNumeroInput">N° de Unidad Educativa:</label>
                    <input type="text" id="colegioNumeroInput" placeholder="Ej: 5093, 3135"
       inputmode="numeric" pattern="[0-9]*" autocapitalize="off" autocorrect="off" spellcheck="false">
                </div>
                <div class="search-section">
                    <button class="button" id="btnBuscarOrientacionesPorColegio" onclick="buscarOrientacionesPorColegio(event)" aria-label="Buscar orientaciones por número de colegio">Buscar Orientaciones del Colegio</button>
                </div>
                <div class="results-container">
                    <h3>Orientaciones Encontradas</h3>
                    <div id="orientacionesPorColegioResults">
                        <div class="results-table-container">
                            <p class="no-results"><i class="fas fa-graduation-cap"></i> Aquí se mostrarán las orientaciones del colegio.</p>
                        </div>
                    </div>
                    <button class="button" onclick="printTableResults('orientacionesPorColegioResults')">Imprimir Orientaciones del Colegio</button>
                </div>
            </section>
        </section>

        <section id="normativas" class="content-section">
            <h2>Normativas y Documentos Oficiales</h2>
            <p>Accede a la legislación vigente y documentos de interés relacionados con la función docente y la Junta Calificadora de Méritos y Disciplina. Es crucial verificar la última versión de cada normativa en fuentes oficiales.</p>
            <ul>
                <li><a href="https://drive.google.com/file/d/1SLEZ-qWbe2iSumm685_ivbH9gtF5tRBs/view?pli=1">-CIRCULAR DE INSCRIPCION 01/25</a></li>
                <li><a href="http://www.bnm.me.gov.ar/giga1/documentos/EL006396.pdf" target="_blank" rel="noopener noreferrer">Ley N° 7546 - Ley Provincial de Educación</a></li>
                <li><a href="https://boletinoficialsalta.gob.ar/Texto_Actualizado.php?c=YXdlcnR5dGFibGE9THw2ODMwJmNhYmU9PGg2PiBQdWJsaWNhZG8gZW4gZWwgQm9sZXTDg8KtbiBPZmljaWFsIE7DgsKwMCwgaWwgZCDDgsKtYSAgZGUgZGUgPC9oNj48QlI+cXdlcnR5" target="_blank" rel="noopener noreferrer">Ley N° 6830/95 - Ley de Educación</a></li>
                <li><a href="https://boletinoficialsalta.gob.ar/instrumento.php?cXdlcnR5dGFibGE9UnwxODUxLzA4cXdlcnR5" target="_blank" rel="noopener noreferrer">Resolución N° 1851/08. RÉGIMEN DE VALORACIÓN DE ANTECEDENTES PARA LA CARRERA DOCENTE</a></li>
                <li><a href="https://www.edusalta.gov.ar/index.php/docentes/normativa-educativa/resoluciones/6568-res-min-n-332-24/file" target="_blank" rel="noopener noreferrer">Resolución N° 332/24.L.C.O. Reconocimiento oficial</a></li>
                <li><a href="https://boletinoficialsalta.gob.ar/instrumento.php?cXdlcnR5dGFibGE9Unw5NzgvMjJxd2VydHk=" target="_blank" rel="noopener noreferrer">Resolución N° 978/22. REGLAMENTO DE ASCENSOS JERÁRQUICOS</a></li>
                <li><a href="https://www.edusalta.gov.ar/index.php/docentes/normativa-educativa/resoluciones/2698-res-min-no-3666-12/file" target="_blank" rel="noopener noreferrer">Resolución N° 3666/12 - Reglamento para Inscripción en Escuelas de Educación Secundaria y Técnico Profesional</a></li>
            </ul>
        </section>

        <section id="tramites" class="content-section">
            <h2>Trámites y Consultas Frecuentes</h2>
            <p>Encuentra información útil sobre los trámites más comunes y resuelve tus dudas.</p>

            <h3>Incumbencias Docentes</h3>
            <p>Consulta las incumbencias de tu título para conocer los espacios curriculares que puedes dictar. Utiliza nuestro <a href="#" onclick="event.preventDefault(); showSection('herramientas-consulta');" class="link-to-buscador">buscador de títulos y espacios curriculares</a> ubicado en la sección de Herramientas de Consulta.</p>

            <h3>Procedimientos para Inscripción</h3>
            <p>Leer como paso esencial la Circular 01/25, como guía de una buena inscripción. </p>
            <p style="text-align: center; margin-top: 10px; margin-bottom: 20px;">
                <a href="https://drive.google.com/file/d/1SLEZ-qWbe2iSumm685_ivbH9gtF5tRBs/view" target="_blank" rel="noopener noreferrer" style="color: #007bff; text-decoration: underline; font-weight: bold;">
                    Ver Circular 01/25 (Guía de Inscripción)
                </a>
            </p>
        <div class="search-group">
            <h3>Acciones de capacitación con puntaje</h3>
            <div class="tabs-container">
                <div class="tabs">
                    <button class="tab-button active" data-tab="resol332">Resolución 332/24</button>
                    <button class="tab-button" data-tab="resol721">Resolución 721/08</button>
                </div>
                
                <div class="tab-content active" id="resol332">
                    <p>Capacitaciones vigentes según Resolución 332/24:</p>
                    <a href="https://docs.google.com/spreadsheets/d/1kEh7E0H3UXsJAl4Elegd2lNvNrjdLNvE/edit?gid=838291378#gid=838291378" 
                       target="_blank" 
                       class="button" 
                       rel="noopener noreferrer">
                        <i class="fas fa-external-link-alt"></i> Consultar Capacitaciones 332/24
                    </a>
                </div>
                
                <div class="tab-content" id="resol721">
                    <p>Capacitaciones históricas según Resolución 721/08:</p>
                    <div class="year-buttons">
                        <a href="https://drive.google.com/drive/u/0/folders/19TxqCiGTnGuvwa6GfPlgSpiHxlFVqXB-" 
                           target="_blank" 
                           class="button small-button" 
                           rel="noopener noreferrer">
                            <i class="fas fa-folder-open"></i> Año 2024
                        </a>
                        <a href="https://drive.google.com/drive/folders/1BKbjYjeDvcNZWyzjzxHE08WYnuJq15je" 
                           target="_blank" 
                           class="button small-button" 
                           rel="noopener noreferrer">
                            <i class="fas fa-folder-open"></i> Año 2023
                        </a>
                        <a href="https://drive.google.com/drive/folders/1YmjQcWZ2px4RsrL9wAo3X9wvmIOHuvyV" 
                           target="_blank" 
                           class="button small-button" 
                           rel="noopener noreferrer">
                            <i class="fas fa-folder-open"></i> Año 2022
                        </a>
                    </div>
                </div>
            </div>
        </div>

            <h3>Preguntas Frecuentes (FAQ)</h3>
            <p>Encuentra respuestas a las preguntas más comunes sobre la Junta Calificadora, trámites, documentación y procedimientos.</p>
        </section>

        <section id="noticias" class="content-section" style="text-align: center;">
            <div id="dynamic-news-feed" style="margin-bottom: 30px;">
                    <h3>Últimas Noticias</h3>
                    <p class="no-results" id="loading-news-message">Cargando noticias...</p>
            </div>
            
            <div class="news-iframe-container">
                <iframe src="https://sga.edusalta.gov.ar/Frontend/Modulos/Noticias/Noticias.aspx" title="Noticias Ministerio de Educación Salta" loading="lazy"></iframe>
            </div>

            <p style="margin-top: 20px;">
                <a href="https://sga.edusalta.gov.ar/Frontend/Modulos/Noticias/Noticias.aspx" target="_blank" rel="noopener noreferrer" style="color: #007bff; text-decoration: underline; font-weight: bold;">
                    Ver noticias directamente en el portal del Ministerio (abre en una nueva pestaña)
                </a>
            </p>
        </section>

        <section id="contacto" class="content-section">
            <h2>Contacto</h2>
            <p>Para consultas, puedes contactarnos a través de los siguientes medios:</p>
            <p><strong>Dirección:</strong> Pje Fernando Ramos N° 22. Salta - Capital.</p>
            <p><strong>Teléfonos:</strong> 387 5344660 / 387 5344662</p>
            <p><strong>Correo Electrónico:</strong> <a href="mailto:juntacalificadorasecundario23@gmail.com">juntacalificadorasecundario23@gmail.com</a></p>
            <p><strong>Horario de Atención:</strong> Lunes a Viernes de 08:00 a 18:00 horas</p>
            <div class="form-container" style="margin-top: 30px; margin-bottom: 30px; text-align: center; max-width: 600px; margin-left: auto; margin-right: auto; padding: 20px; border: 1px solid #ddd; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                <h3>Envíanos un Mensaje</h3>
                <!-- Código de incrustación de Formly -->
                <iframe
                    data-formly-embed
                    data-formly-form-id='HO93BF'
                    style='width: 100%; min-height: 700px; border: none;' <!-- Altura ajustada aquí -->
                    loading='lazy'
                    title='Formulario de Contacto'
                ></iframe>
                <script async src='https://cdn.formly.so/widgets/embed.js'></script>
            </div>
            <h3>Nuestra Ubicación</h3>
            <div class="map-container">
                <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3621.579482598387!2d-65.4093959885822!3d-24.62916857997972!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x941bc3a18a99499d%3A0x7df6b0d9e8c4e43b!2sPje%20Fernando%20Ramos%2022%2C%20A4400%20Salta!5e0!3m2!1ses-419!2sar!4v1700000000000!5m2!1ses-419!2sar" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
            </div>
            <p style="text-align: center; margin-top: 15px;">
                <a href="https://www.google.com/maps/place/Pje+Fernando+Ramos+22,+A4400+Salta" target="_blank" rel="noopener noreferrer" style="color: #007bff; text-decoration: underline;">Abrir en Google Maps</a>
            </p>
        </section>
    </div>

    <footer>
        <p>© JCMyD- N.S. 2025 | Derechos Reservados</p>
        <p>Webmaster: susje®</p> 
    </footer>

    <script>
        // =============================================
        // CONFIGURACIONES Y CONSTANTES
        // =============================================
        const CONFIG = {
            sheets: {
                competencias: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vS-EPPyl34acCgd03fTldc-6Bs7GhBXdAmKVoaIHJKT-5SW4c8VzIDGCNqU7E590SxXlHKPvu-U_qwr/pub?gid=1550756964&single=true&output=csv',
                orientaciones: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vS7Qnph7TWvhLYl3KhpaDVqnYLqgNGbQ7FNtdw7TNzAlskfjVTg4DePvG2MoVuZf9DD3Fc2nZ5CEOms/pub?gid=1943513223&single=true&output=csv',
                colegios: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vStnrtyd-dwtpz4UlSU2OXrEgL79AlvRLL3c0mIPSGETpyT2sEVgaGjJOVSpryEC7Jhx4zM6HjKWZN_/pub?gid=119647774&single=true&output=csv',
                planEstudio: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRHqqcFr4mP1vwyt14wUjjMCryhv8bzp-A7Dum5jRKqGvQ5_nJYZlo23Q-90L6cPFKFoUXiFTiMKzI7/pub?gid=151813776&single=true&output=csv'
            },
            selectors: {
                menuToggle: '#mobile-menu',
                mainNav: '#main-nav',
                tituloInput: '#tituloInputIntegrado',
                espacioSelect: '#espacioCurricularSelect',
                departamentoSelect: '#departamentoSelect',
                btnBuscarColegios: '#btnBuscarColegios'
            }
        };
        
        // =============================================
        // VARIABLES GLOBALES
        // =============================================
        let competenciasData = [];
        let orientacionesData = [];
        let colegiosData = [];
        let planEstudioData = [];
        let foundEspaciosCurriculares = [];
        
        // =============================================
        // FUNCIONES DE INICIALIZACIÓN
        // =============================================
        function init() {
            setupNavigation();
            loadAllData();
            setupEventListeners();
            showInitialSection();
        }
        
        // =============================================
        // NAVEGACIÓN Y UI
        // =============================================
        function setupNavigation() {
            const menuToggle = document.querySelector(CONFIG.selectors.menuToggle);
            const mainNav = document.querySelector(CONFIG.selectors.mainNav);
            
            if (menuToggle && mainNav) {
                menuToggle.addEventListener('click', () => {
                    menuToggle.classList.toggle('active');
                    mainNav.classList.toggle('active');
                    const expanded = mainNav.classList.contains('active');
                    menuToggle.setAttribute('aria-expanded', expanded);
                });
            }
            
            document.querySelectorAll('header nav ul li a').forEach(link => {
                link.addEventListener('click', function(event) {
                    event.preventDefault();
                    const sectionId = this.getAttribute('href').substring(1);
                    showSection(sectionId);
                });
            });
        }
        
        function showSection(sectionId) {
            const allSections = document.querySelectorAll('.content-section');
            allSections.forEach(section => {
                section.style.display = 'none';
            });

            const targetSection = document.getElementById(sectionId);
            if (targetSection) {
                targetSection.style.display = 'block';
                // Desplazamiento suave
                setTimeout(() => {
                    targetSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }, 100);
            }

            const navLinks = document.querySelectorAll('header nav ul li a');
            navLinks.forEach(link => link.classList.remove('active-nav-link'));
            
            const activeLink = document.querySelector(`header nav ul li a[href="#${sectionId}"]`);
            if (activeLink) {
                activeLink.classList.add('active-nav-link');
            }
            
            const mainNav = document.getElementById('main-nav');
            const mobileMenu = document.getElementById('mobile-menu');
            if (mainNav && mobileMenu && mainNav.classList.contains('active')) {
                mainNav.classList.remove('active');
                mobileMenu.classList.remove('active');
                mobileMenu.setAttribute('aria-expanded', 'false');
            }
        }
        
        function showInitialSection() {
            const initialSection = window.location.hash ? window.location.hash.substring(1) : 'inicio';
            showSection(initialSection);
        }
        
        // =============================================
        // CARGA DE DATOS
        // =============================================
        async function loadAllData() {
            try {
                const [compData, orientData, coleData, planData] = await Promise.all([
                    loadData(CONFIG.sheets.competencias, 'competencias'),
                    loadData(CONFIG.sheets.orientaciones, 'orientaciones'),
                    loadData(CONFIG.sheets.colegios, 'colegios'),
                    loadData(CONFIG.sheets.planEstudio, 'planEstudio')
                ]);
                
                competenciasData = compData;
                orientacionesData = orientData;
                colegiosData = coleData;
                planEstudioData = planData;
                
                populateDepartamentosSelect();
                populateCategoriaDepartamentosSelect();
            } catch (error) {
                console.error('Error cargando datos:', error);
                showErrorNotification('Error al cargar datos. Por favor recarga la página.');
            }
        }
        
        async function loadData(url, type) {
            try {
                console.log(`Cargando datos desde: ${url} (Tipo: ${type})`);
                const response = await fetch(url);
                if (!response.ok) {
                    if (response.status === 404) {
                        alert(`¡Advertencia! Error 404: No se pudo cargar la hoja de ${type} desde la URL. Por favor, verifica que la URL es correcta y que la hoja de Google Sheets está 'Publicada en la web' como CSV.`);
                    }
                    throw new Error(`HTTP error! status: ${response.status} al cargar ${type}`);
                }
                const csvText = await response.text();
                return parseCSV(csvText, type);
            } catch (error) {
                console.error(`Error cargando datos de ${type} desde ${url}:`, error);
                if (type === 'colegios') {
                     alert('¡Advertencia! Error cargando la lista de Colegios. Algunas funciones podrían no operar correctamente. Por favor, revisa la consola para más detalles y asegúrate que la URL de COLEGIOS_URL es correcta y pública.');
                } else if (type === 'planEstudio') { 
                    alert('¡Advertencia! Error cargando los datos del Plan de Estudio. La búsqueda de colegios por espacio curricular podría no funcionar. Por favor, revisa la consola para más detalles y asegúrate que la URL de PLAN_ESTUDIO_URL es correcta y pública.');
                }
                return [];
            }
        }

            // --- Noticias Dinámicas desde Google Sheet ---
            // ¡REEMPLAZA ESTA URL CON LA URL DE PUBLICACIÓN CSV DE TU GOOGLE SHEET!
            const GOOGLE_SHEET_NEWS_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTgPwmVUURlmyG5QkvUI2O44EnW45zjngwFKd51qe6O6gg-VXeT9C98_uXgZd3f6owUox4ImBJpUadc/pub?gid=0&single=true&output=csv';
            const dynamicNewsFeed = document.getElementById('dynamic-news-feed');
            const loadingNewsMessage = document.getElementById('loading-news-message');
        
            function processNewsContent(content) {
                if (!content) return '<p>Sin contenido.</p>';
            
                // Dividir el contenido por saltos de línea
                const lines = content.split('\n').map(line => line.trim()).filter(line => line !== '');
                let html = '';
                let inList = false;
            
                lines.forEach(line => {
                    // Detectar elementos de lista (comienzan con "·" o "-")
                    if (line.startsWith('·') || line.startsWith('-')) {
                        const listItem = line.replace(/^[·-]\s*/, ''); // Eliminar el marcador de lista
                        if (!inList) {
                            html += '<ul class="news-list">';
                            inList = true;
                        }
                        // Detectar enlaces en la línea (por ejemplo, "(DESCARGAR)")
                        const processedLine = processLinksInLine(listItem);
                        html += `<li>${processedLine}</li>`;
                    } else {
                        // Cerrar lista si estaba abierta
                        if (inList) {
                            html += '</ul>';
                            inList = false;
                        }
                        // Detectar enlaces en la línea
                        const processedLine = processLinksInLine(line);
                        html += `<p>${processedLine}</p>`;
                    }
                });
            
                // Cerrar lista si quedó abierta
                if (inList) {
                    html += '</ul>';
                }
            
                return html;
            }
            
            function processLinksInLine(line) {
                // Detectar enlaces con formato "(DESCARGAR)"
                const linkRegex = /\((DESCARGAR)\)/gi;
                return line.replace(linkRegex, (match, linkText) => {
                    // Usa un enlace placeholder; reemplázalo con la URL real si está disponible
                    return `<a href="#" class="inline-link" target="_blank" rel="noopener noreferrer">${linkText}</a>`;
                });
            }
            async function fetchAndDisplayNews() {
                const dynamicNewsFeed = document.getElementById('dynamic-news-feed');
                const loadingNewsMessage = document.getElementById('loading-news-message');
                if (!dynamicNewsFeed || !loadingNewsMessage) {
                    console.error('Elementos HTML para noticias dinámicas (dynamic-news-feed o loading-news-message) no encontrados.');
                    return;
                }
            
                try {
                    // Reiniciar el contenido y mostrar mensaje de carga
                    dynamicNewsFeed.innerHTML = '<h3>Últimas Noticias</h3><p class="no-results" id="loading-news-message">Cargando noticias...</p>';
                    const currentLoadingMessage = document.getElementById('loading-news-message');
            
                    const response = await fetch(GOOGLE_SHEET_NEWS_URL);
                    if (!response.ok) {
                        throw new Error(`Error HTTP! Estado: ${response.status}`);
                    }
                    const csvText = await response.text();
                    const newsData = parseCSV(csvText);
            
                    if (newsData.length === 0) {
                        dynamicNewsFeed.innerHTML = '<h3>Últimas Noticias</h3><p class="no-results">No hay noticias disponibles en este momento.</p>';
                        return;
                    }
            
                    // Eliminar el mensaje de carga
                    if (currentLoadingMessage) {
                        currentLoadingMessage.remove();
                    }
            
                    // Iterar sobre los datos de las noticias y crear elementos HTML
                    newsData.forEach(newsItem => {
                        const newsDiv = document.createElement('div');
                        newsDiv.classList.add('news-item');
            
                        const title = document.createElement('h4');
                        title.textContent = newsItem.Titulo || 'Sin título';
                        newsDiv.appendChild(title);
            
                        const date = document.createElement('span');
                        date.classList.add('news-date');
                        const rawDateString = newsItem.Fecha ? String(newsItem.Fecha).trim() : '';
                        const dateParts = rawDateString.split('/');
                        let displayDate = 'Fecha desconocida';
            
                        if (dateParts.length === 3) {
                            const day = parseInt(dateParts[0], 10);
                            const month = parseInt(dateParts[1], 10) - 1;
                            const year = parseInt(dateParts[2], 10);
                            if (!isNaN(day) && !isNaN(month) && !isNaN(year)) {
                                const d = new Date(year, month, day);
                                if (!isNaN(d.getTime())) {
                                    displayDate = d.toLocaleDateString('es-AR', { year: 'numeric', month: 'long', day: 'numeric' });
                                }
                            }
                        }
                        date.textContent = displayDate;
                        newsDiv.appendChild(date);
            
                        // Procesar el contenido para manejar párrafos, listas y enlaces
                        const content = document.createElement('div');
                        content.classList.add('news-content');
                        content.innerHTML = processNewsContent(newsItem.Contenido);
                        newsDiv.appendChild(content);
            
                        // Si hay un enlace general, crearlo
                        if (newsItem.Link && newsItem.Link.trim() !== '') {
                            const link = document.createElement('a');
                            link.href = newsItem.Link;
                            link.textContent = newsItem.LinkTexto && newsItem.LinkTexto.trim() !== '' ? newsItem.LinkTexto : 'Leer más';
                            link.classList.add('read-more');
                            link.target = '_blank';
                            link.rel = 'noopener noreferrer';
                            newsDiv.appendChild(link);
                        }
            
                        dynamicNewsFeed.appendChild(newsDiv);
                    });
            
                } catch (error) {
                    console.error('Error al cargar las noticias:', error);
                    dynamicNewsFeed.innerHTML = '<h3>Últimas Noticias</h3><p class="no-results">Error al cargar las noticias. Por favor, intente más tarde.</p>';
                }
            }
        
            // --- Función parseCSV robusta (¡DEBE SER LA ÚNICA EN TU CÓDIGO!) ---
           function parseCSV(csvText) {
                const parsed = Papa.parse(csvText, {
                    header: true,
                    skipEmptyLines: true,
                    quoteChar: '"',
                    escapeChar: '"',
                    transform: value => value.trim()
                });
                return parsed.data;
            }
            // --- Fin de la función parseCSV robusta ---
        
        
            // Llama a la función de carga de noticias cuando la página se haya cargado completamente
            document.addEventListener('DOMContentLoaded', fetchAndDisplayNews);
        
            // --- Fin Noticias Dinámicas ---
            
        
        // =============================================
        // FUNCIONES DE BÚSQUEDA
        // =============================================
        function normalizeText(text) {
            if (typeof text !== 'string') return '';
            return text.normalize('NFD').replace(/[\u0300-\u036f]/g, "").toLowerCase();
        }
        
        function highlightMatch(text, query) {
            if (!text || !query) return text;
            const normalizedText = normalizeText(text);
            const normalizedQuery = normalizeText(query);

            let lastIndex = 0;
            let highlightedHtml = '';
            let match;

            const regex = new RegExp(normalizedQuery.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'gi');
            
            while ((match = regex.exec(normalizedText)) !== null) {
                highlightedHtml += text.substring(lastIndex, match.index);
                highlightedHtml += '<strong>' + text.substring(match.index, regex.lastIndex) + '</strong>';
                lastIndex = regex.lastIndex;
            }
            
            highlightedHtml += text.substring(lastIndex);
            return highlightedHtml;
        }
        
       function renderTable(containerId, headers, data, htmlColumns = [], searchTerm = '', exactHighlightColumn = null, clickableColumn = null) {
            const container = document.getElementById(containerId);
            if (!container) return;
        
            container.innerHTML = '';
            const normalizedSearchTerm = normalizeText(searchTerm);
        
            if (data.length === 0) {
                container.innerHTML = `
                    <div class="no-results">
                        <i class="fas fa-search"></i>
                        <p>No se encontraron resultados para "${searchTerm}"</p>
                        <small>Intenta con términos más generales o verifica la ortografía</small>
                    </div>
                `;
                return;
            }
        
            const table = document.createElement('table');
            table.classList.add('results-table');
        
            // Crear encabezados con saltos de línea
            const thead = document.createElement('thead');
            const headerRow = document.createElement('tr');
            headers.forEach(headerText => {
                const th = document.createElement('th');
                // Manejar encabezados compuestos
                if (headerText.includes('/')) {
                    const parts = headerText.split('/');
                    th.innerHTML = `${parts[0]}<br/><small>${parts[1]}</small>`;
                } else {
                    th.textContent = headerText;
                }
                headerRow.appendChild(th);
            });
            thead.appendChild(headerRow);
            table.appendChild(thead);
        
            // Crear cuerpo de la tabla
            const tbody = document.createElement('tbody');
            let lastTitle = '';
            
            data.forEach((item, index) => {
                const tr = document.createElement('tr');
                let rowShouldBeHighlighted = false;
                const currentTitle = item['Titulo'] || '';
        
                // Determinar si la fila debe resaltarse
                if (exactHighlightColumn && item[exactHighlightColumn] !== undefined) {
                    const columnContent = normalizeText(String(item[exactHighlightColumn]));
                    if (columnContent === normalizedSearchTerm) {
                        rowShouldBeHighlighted = true;
                    }
                } else if (normalizedSearchTerm) {
                    for (const headerKey of headers) {
                        const cellContent = item[headerKey] !== undefined ? String(item[headerKey]) : '';
                        if (normalizeText(cellContent).includes(normalizedSearchTerm)) {
                            rowShouldBeHighlighted = true;
                            break;
                        }
                    }
                }
        
                // Crear celdas
                headers.forEach(headerKey => {
                    const td = document.createElement('td');
                    let cellContent = item[headerKey] !== undefined ? String(item[headerKey]) : '';
        
                    // Manejar título repetido
                    if (headerKey === 'Titulo') {
                        if (index > 0 && currentTitle === lastTitle) {
                            if (window.innerWidth > 768) { // Desktop
                                cellContent = '<span class="repeated-title">(Igual al título seleccionado)</span>';
                            } else { // Mobile
                                cellContent = '<span class="repeated-title">""</span>';
                            }
                        }
                    }
        
                    if (htmlColumns.includes(headerKey)) {
                        if (clickableColumn === headerKey) {
                            const clickableSpan = document.createElement('span');
                            clickableSpan.classList.add('clickable-title');
                            clickableSpan.dataset.fullTitle = item[headerKey].replace(/<\/?strong>/g, '');
                            clickableSpan.innerHTML = cellContent;
                            clickableSpan.onclick = () => filterAndDisplayExactTitle(clickableSpan.dataset.fullTitle);
                            td.appendChild(clickableSpan);
                        } else {
                            td.innerHTML = cellContent;
                        }
                    } else {
                        if (headerKey === 'Titulo' && (index > 0 && currentTitle === lastTitle)) {
                            td.innerHTML = cellContent;
                        } else {
                            td.textContent = cellContent;
                        }
                    }
                    
                    // Añadir clase específica para columnas estrechas
                    if (headerKey === 'CODIGO/Modulo' || headerKey === 'Alcance/INCUMBENCIA') {
                        td.classList.add('narrow-column');
                    }
                    
                    td.setAttribute('data-col-name', headerKey);
                    tr.appendChild(td);
                });
        
                if (rowShouldBeHighlighted) {
                    tr.classList.add('highlighted-row');
                }
        
                tbody.appendChild(tr);
                lastTitle = currentTitle;
            });
            
            table.appendChild(tbody);
            container.appendChild(table);
        }
        
        // =============================================
        // BUSCADORES PRINCIPALES
        // =============================================
        function buscarIncumbenciasIntegrado(event) {
            const button = event.target;
            const originalButtonText = button.innerHTML;
            button.innerHTML = originalButtonText + '<span class="loading-spinner" aria-hidden="true"></span>';
            button.disabled = true;
        
            const inputElement = document.getElementById('tituloInputIntegrado');
            const rawInput = inputElement.value.trim();
            const normalizedInput = normalizeText(rawInput);
        
            const selectEspacio = document.getElementById('espacioCurricularSelect');
            const selectDepartamento = document.getElementById('departamentoSelect');
            const btnBuscarColegios = document.getElementById('btnBuscarColegios');
        
            // Resetear resultados anteriores
            renderTable('incumbenciasResultsIntegrado', ['Titulo', 'Nombre DEL ESPACIO CURRICULAR', 'CODIGO/Modulo', 'Alcance/INCUMBENCIA'], []);
            renderTable('colegiosPorEspacioResults', ['Nombre', 'Direccion', 'Localidad', 'Departamento'], []);
        
            selectEspacio.innerHTML = '<option value="">-- Selecciona un espacio curricular --</option>';
            selectEspacio.disabled = true;
            btnBuscarColegios.disabled = true;
            foundEspaciosCurriculares = [];
        
            if (!normalizedInput) {
                document.getElementById('incumbenciasResultsIntegrado').innerHTML = `
                    <div class="no-results">
                        <i class="fas fa-exclamation-circle"></i>
                        <p>Por favor, ingresa un título para buscar incumbencias</p>
                    </div>
                `;
                button.innerHTML = originalButtonText;
                button.disabled = false;
                return;
            }
        
            // Filtrado mejorado - Priorizar coincidencias exactas en Título
            const filteredData = competenciasData.filter(item => {
                const titulo = normalizeText(item['Titulo'] || '');
                const espacioCurricular = normalizeText(item['Nombre DEL ESPACIO CURRICULAR'] || '');
                
                // Primero buscar coincidencias exactas o parciales en Título
                if (titulo.includes(normalizedInput)) {
                    return true;
                }
                
                // Solo si no hay suficientes resultados en Título, buscar en Espacio Curricular
                return false;
            });
        
            // Si no hay resultados en Título, buscar en Espacios Curriculares
            let dataToRender = [];
            if (filteredData.length === 0) {
                const filteredByEspacio = competenciasData.filter(item => {
                    const espacioCurricular = normalizeText(item['Nombre DEL ESPACIO CURRICULAR'] || '');
                    return espacioCurricular.includes(normalizedInput);
                });
                
                if (filteredByEspacio.length > 0) {
                    dataToRender = filteredByEspacio.map(item => {
                        return {
                            ...item,
                            'Titulo': item['Titulo'],
                            'Nombre DEL ESPACIO CURRICULAR': highlightMatch(item['Nombre DEL ESPACIO CURRICULAR'], rawInput)
                        };
                    });
                    
                    // Mostrar mensaje explicativo
                    document.getElementById('incumbenciasResultsIntegrado').innerHTML = `
                        <div class="info-message">
                            <i class="fas fa-info-circle"></i>
                            <p>No se encontraron títulos que coincidan con "${rawInput}". Mostrando espacios curriculares relacionados.</p>
                        </div>
                    `;
                }
            } else {
                // Preparar datos para renderizar (solo títulos)
                dataToRender = filteredData.map(item => {
                    return {
                        ...item,
                        'Titulo': highlightMatch(item['Titulo'], rawInput)
                    };
                });
            }
        
            // Renderizar tabla
            if (dataToRender.length > 0) {
                renderTable(
                    'incumbenciasResultsIntegrado',
                    ['Titulo', 'Nombre DEL ESPACIO CURRICULAR', 'CODIGO/Modulo', 'Alcance/INCUMBENCIA'],
                    dataToRender,
                    ['Titulo'],
                    rawInput,
                    'Titulo',
                    'Titulo'
                );
        
                // Llenar select con espacios curriculares encontrados
                const uniqueEspacios = new Set();
                dataToRender.forEach(item => {
                    if (item['Nombre DEL ESPACIO CURRICULAR']) {
                        uniqueEspacios.add(item['Nombre DEL ESPACIO CURRICULAR'].trim());
                    }
                });
        
                foundEspaciosCurriculares = Array.from(uniqueEspacios).sort();
                selectEspacio.innerHTML = '<option value="">-- Selecciona un espacio curricular --</option>';
                
                foundEspaciosCurriculares.forEach(espacio => {
                    const option = document.createElement('option');
                    option.value = espacio;
                    option.textContent = espacio;
                    selectEspacio.appendChild(option);
                });
                
                selectEspacio.disabled = false;
            } else {
                document.getElementById('incumbenciasResultsIntegrado').innerHTML = `
                    <div class="no-results">
                        <i class="fas fa-search"></i>
                        <p>No se encontraron títulos ni espacios curriculares para "${rawInput}"</p>
                        <small>Intenta con términos más específicos o revisa la ortografía</small>
                    </div>
                `;
            }
            
            toggleBuscarColegiosButton();
            button.innerHTML = originalButtonText;
            button.disabled = false;
        }
        
        function buscarColegiosAleatoriosPorEspacio(event) {
            const button = event.target;
            const originalButtonText = button.innerHTML;
            button.innerHTML = originalButtonText + '<span class="loading-spinner" aria-hidden="true"></span>';
            button.disabled = true;

            const selectedEspacio = document.getElementById('espacioCurricularSelect').value;
            const selectedDepartamento = document.getElementById('departamentoSelect').value;
            
            renderTable('colegiosPorEspacioResults', ['Nombre', 'Direccion', 'Localidad', 'Departamento'], []);

            if (!selectedEspacio) {
                document.getElementById('colegiosPorEspacioResults').innerHTML = `
                    <div class="no-results">
                        <i class="fas fa-exclamation-circle"></i>
                        <p>Por favor, selecciona un espacio curricular</p>
                    </div>
                `;
                button.innerHTML = originalButtonText;
                button.disabled = false;
                return;
            }
            
            if (!selectedDepartamento) {
                document.getElementById('colegiosPorEspacioResults').innerHTML = `
                    <div class="no-results">
                        <i class="fas fa-exclamation-circle"></i>
                        <p>Por favor, selecciona un departamento</p>
                    </div>
                `;
                button.innerHTML = originalButtonText;
                button.disabled = false;
                return;
            }
            
            if (!colegiosData || colegiosData.length === 0 || !planEstudioData || planEstudioData.length === 0) {
                 document.getElementById('colegiosPorEspacioResults').innerHTML = `
                    <div class="no-results">
                        <i class="fas fa-exclamation-triangle"></i>
                        <p>Los datos de colegios o plan de estudio no se cargaron correctamente</p>
                        <small>Intenta recargar la página</small>
                    </div>
                `;
                console.error('Datos de colegiosData o planEstudioData no disponibles para la búsqueda aleatoria.');
                button.innerHTML = originalButtonText;
                button.disabled = false;
                return;
            }

            // 1. Obtener UEs en el departamento seleccionado
            const uesEnDepartamento = colegiosData.filter(c =>
                c['Departamento'] && normalizeText(c['Departamento']) === normalizeText(selectedDepartamento) && c['NumeroUE']
            ).map(c => String(c['NumeroUE']).trim());

            if (uesEnDepartamento.length === 0) {
                document.getElementById('colegiosPorEspacioResults').innerHTML = `
                    <div class="no-results">
                        <i class="fas fa-search"></i>
                        <p>No se encontraron colegios en "${selectedDepartamento}"</p>
                    </div>
                `;
                button.innerHTML = originalButtonText;
                button.disabled = false;
                return;
            }

            // 2. Filtrar por espacio curricular y departamento
            const colegiosConEspacioYDepartamento = planEstudioData.filter(item => {
                const espacio = normalizeText(item['ESPACIO CURRICULAR'] || '');
                const ue = item['UE'] ? String(item['UE']).trim() : '';
                return espacio === normalizeText(selectedEspacio) && uesEnDepartamento.includes(ue);
            });

            if (colegiosConEspacioYDepartamento.length === 0) {
                document.getElementById('colegiosPorEspacioResults').innerHTML = `
                    <div class="no-results">
                        <i class="fas fa-search"></i>
                        <p>No se encontraron colegios en "${selectedDepartamento}" que dicten "${selectedEspacio}"</p>
                    </div>
                `;
                button.innerHTML = originalButtonText;
                button.disabled = false;
                return;
            }

            // 3. Obtener UEs únicos
            const numerosUnicosUEFiltrados = new Set();
            colegiosConEspacioYDepartamento.forEach(item => {
                if (item['UE']) {
                    numerosUnicosUEFiltrados.add(item['UE'].trim());
                }
            });

            const uesDisponibles = Array.from(numerosUnicosUEFiltrados);
            
            // 4. Seleccionar 7 colegios al azar
            const uesAleatorios = [];
            let numColegios = Math.min(7, uesDisponibles.length);
            let tempUEs = [...uesDisponibles];

            for (let i = 0; i < numColegios; i++) {
                const randomIndex = Math.floor(Math.random() * tempUEs.length);
                const randomUE = tempUEs[randomIndex];
                uesAleatorios.push(randomUE);
                tempUEs.splice(randomIndex, 1);
            }

            // 5. Buscar detalles de los colegios seleccionados
            const resultadosFinales = [];
            uesAleatorios.forEach(numeroUE => {
                const colegioDetalle = colegiosData.find(c =>
                    String(c['NumeroUE']).trim() === String(numeroUE).trim()
                );
                
                if (colegioDetalle) {
                    resultadosFinales.push({
                        'Nombre': colegioDetalle['Nombre'],
                        'Direccion': colegioDetalle['Direccion'],
                        'Localidad': colegioDetalle['Localidad'],
                        'Departamento': colegioDetalle['Departamento']
                    });
                } else {
                    resultadosFinales.push({
                        'Nombre': `Nº ${numeroUE} (Nombre no encontrado)`,
                        'Direccion': 'No disponible',
                        'Localidad': 'No disponible',
                        'Departamento': 'No disponible'
                    });
                    console.warn(`Detalles no encontrados en colegiosData para el NumeroUE: ${numeroUE}`);
                }
            });

            renderTable(
                'colegiosPorEspacioResults',
                ['Nombre', 'Direccion', 'Localidad', 'Departamento'],
                resultadosFinales,
                [],
                `${selectedEspacio} ${selectedDepartamento}`
            );
            
            button.innerHTML = originalButtonText;
            button.disabled = false;
        }
        
        function buscarOrientaciones(event) {
            const button = event.target;
            const originalButtonText = button.innerHTML;
            button.innerHTML = originalButtonText + '<span class="loading-spinner" aria-hidden="true"></span>';
            button.disabled = true;

            const inputElement = document.getElementById('orientacionInput');
            const rawInput = inputElement.value;
            const normalizedInput = normalizeText(rawInput);
            
            if (!normalizedInput) {
                renderTable('orientacionesResults', ['UNID EDUCATIVA', 'ORIENTACION', 'AREA GEOGRAFICA- LOCALIDAD-DPTO'], []);
                button.innerHTML = originalButtonText;
                button.disabled = false;
                return;
            }

            const filtered = orientacionesData.filter(item => {
                const orientacion = normalizeText(item['ORIENTACION'] || '');
                const unidEducativa = normalizeText(item['UNID EDUCATIVA'] || '');
                const areaGeo = normalizeText(item['AREA GEOGRAFICA- LOCALIDAD-DPTO'] || '');

                return orientacion.includes(normalizedInput) || 
                       unidEducativa.includes(normalizedInput) || 
                       areaGeo.includes(normalizedInput);
            });

            renderTable(
                'orientacionesResults',
                ['UNID EDUCATIVA', 'ORIENTACION', 'AREA GEOGRAFICA- LOCALIDAD-DPTO'],
                filtered,
                [],
                rawInput
            );
            
            button.innerHTML = originalButtonText;
            button.disabled = false;
        }
        
        function buscarColegios(event) {
            const button = event.target;
            const originalButtonText = button.innerHTML;
            button.innerHTML = originalButtonText + '<span class="loading-spinner" aria-hidden="true"></span>';
            button.disabled = true;

            const inputElement = document.getElementById('localidadInput');
            const rawInput = inputElement.value;
            const normalizedInput = normalizeText(rawInput);
            
            if (!normalizedInput) {
                renderTable('colegiosResults', ['Nombre', 'Direccion', 'Localidad', 'Departamento', 'CodPostal'], []);
                button.innerHTML = originalButtonText;
                button.disabled = false;
                return;
            }

            const filtered = colegiosData.filter(item => {
                const localidad = normalizeText(item['Localidad'] || '');
                const departamento = normalizeText(item['Departamento'] || '');
                const direccion = normalizeText(item['Direccion'] || '');
                const nombre = normalizeText(item['Nombre'] || '');
                const codPostal = normalizeText(item['CodPostal'] || '');

                return localidad.includes(normalizedInput) || 
                       departamento.includes(normalizedInput) || 
                       direccion.includes(normalizedInput) || 
                       nombre.includes(normalizedInput) || 
                       codPostal.includes(normalizedInput);
            });

            renderTable(
                'colegiosResults',
                ['Nombre', 'Direccion', 'Localidad', 'Departamento', 'CodPostal'],
                filtered,
                [],
                rawInput
            );
            
            button.innerHTML = originalButtonText;
            button.disabled = false;
        }
        
        function buscarColegiosPorCategoria(event) {
            const button = event.target;
            const originalButtonText = button.innerHTML;
            button.innerHTML = originalButtonText + '<span class="loading-spinner" aria-hidden="true"></span>';
            button.disabled = true;

            const categoriaSelect = document.getElementById('categoriaColegioSelect');
            const selectedCategory = categoriaSelect.value;

            const departamentoSelect = document.getElementById('categoriaDepartamentoSelect');
            const selectedDepartamento = departamentoSelect.value;

            const localidadSelect = document.getElementById('categoriaLocalidadSelect');
            const selectedLocalidad = localidadSelect.value;

            const resultsContainer = document.getElementById('colegiosPorCategoriaResults');
            resultsContainer.innerHTML = `
                <div class="results-table-container">
                    <div class="no-results">
                        <i class="fas fa-spinner fa-pulse"></i>
                        <p>Buscando colegios...</p>
                    </div>
                </div>
            `;

            if (!selectedCategory) {
                resultsContainer.innerHTML = `
                    <div class="no-results">
                        <i class="fas fa-exclamation-circle"></i>
                        <p>Por favor, selecciona una categoría de colegio</p>
                    </div>
                `;
                button.innerHTML = originalButtonText;
                button.disabled = false;
                return;
            }

            if (!colegiosData || colegiosData.length === 0) {
                resultsContainer.innerHTML = `
                    <div class="no-results">
                        <i class="fas fa-exclamation-triangle"></i>
                        <p>Datos de colegios no cargados correctamente</p>
                        <small>Intenta recargar la página</small>
                    </div>
                `;
                console.error('Datos de colegiosData no disponibles para la búsqueda por categoría.');
                button.innerHTML = originalButtonText;
                button.disabled = false;
                return;
            }

            let filteredColegios = [];

            // Filtrar por categoría
            switch (selectedCategory) {
                case 'comun': // Secundario Común (Nº 5xxx)
                    filteredColegios = colegiosData.filter(colegio =>
                        colegio.Nombre && (colegio.Nombre.startsWith('Nº 5') || colegio.Nombre.startsWith('N° 5'))
                    );
                    break;
                case 'eet': // EET (Nº 3xxx)
                    filteredColegios = colegiosData.filter(colegio =>
                        colegio.Nombre && (colegio.Nombre.startsWith('Nº 3') || colegio.Nombre.startsWith('N° 3'))
                    );
                    break;
                case 'bspa': // BSPA (Nº 7xxx)
                    filteredColegios = colegiosData.filter(colegio =>
                        colegio.Nombre && (colegio.Nombre.startsWith('Nº 7') || colegio.Nombre.startsWith('N° 7'))
                    );
                    break;
                default:
                    resultsContainer.innerHTML = `
                        <div class="no-results">
                            <i class="fas fa-exclamation-circle"></i>
                            <p>Categoría no reconocida</p>
                        </div>
                    `;
                    button.innerHTML = originalButtonText;
                    button.disabled = false;
                    return;
            }

            // Filtrar por departamento si está seleccionado
            if (selectedDepartamento) {
                filteredColegios = filteredColegios.filter(colegio =>
                    colegio.Departamento && normalizeText(colegio.Departamento) === normalizeText(selectedDepartamento)
                );
            }

            // Filtrar por localidad si está seleccionada
            if (selectedLocalidad) {
                filteredColegios = filteredColegios.filter(colegio =>
                    colegio.Localidad && normalizeText(colegio.Localidad) === normalizeText(selectedLocalidad)
                );
            }
            
            if (filteredColegios.length > 0) {
                const searchTerm = `${selectedCategory} ${selectedDepartamento} ${selectedLocalidad}`.trim();
                renderTable(
                    'colegiosPorCategoriaResults',
                    ['Nombre', 'Direccion', 'Localidad', 'Departamento'],
                    filteredColegios,
                    [],
                    searchTerm
                );
                
                // Desplazar al contenedor de resultados
                const offset = 120;
                const elementPosition = resultsContainer.getBoundingClientRect().top + window.pageYOffset;
                window.scrollTo({ top: elementPosition - offset, behavior: 'smooth' });
            } else {
                resultsContainer.innerHTML = `
                    <div class="no-results">
                        <i class="fas fa-search"></i>
                        <p>No se encontraron colegios con los filtros seleccionados</p>
                    </div>
                `;
            }
            
            button.innerHTML = originalButtonText;
            button.disabled = false;
        }
        
        function buscarOrientacionesPorColegio(event) {
            const button = event.target;
            const originalButtonText = button.innerHTML;
            button.innerHTML = originalButtonText + '<span class="loading-spinner" aria-hidden="true"></span>';
            button.disabled = true;

            const colegioNumeroInput = document.getElementById('colegioNumeroInput');
            const numeroColegio = normalizeText(colegioNumeroInput.value.trim());
            const resultsContainer = document.getElementById('orientacionesPorColegioResults');

            resultsContainer.innerHTML = `
                <div class="results-table-container">
                    <div class="no-results">
                        <i class="fas fa-spinner fa-pulse"></i>
                        <p>Buscando orientaciones...</p>
                    </div>
                </div>
            `;

            if (!numeroColegio) {
                resultsContainer.innerHTML = `
                    <div class="no-results">
                        <i class="fas fa-exclamation-circle"></i>
                        <p>Por favor, ingrese un número de Unidad Educativa</p>
                    </div>
                `;
                button.innerHTML = originalButtonText;
                button.disabled = false;
                return;
            }

            if (!orientacionesData || orientacionesData.length === 0) {
                resultsContainer.innerHTML = `
                    <div class="no-results">
                        <i class="fas fa-exclamation-triangle"></i>
                        <p>Datos de orientaciones no cargados correctamente</p>
                        <small>Intenta recargar la página</small>
                    </div>
                `;
                console.error('Datos de orientacionesData no disponibles para la búsqueda por número de colegio.');
                button.innerHTML = originalButtonText;
                button.disabled = false;
                return;
            }

            const filteredOrientaciones = orientacionesData.filter(item =>
                normalizeText(item['UNID EDUCATIVA'] || '') === numeroColegio
            );

            if (filteredOrientaciones.length > 0) {
                const dataToDisplay = filteredOrientaciones.map(item => ({
                    'UNID EDUCATIVA': item['UNID EDUCATIVA'],
                    'ORIENTACION': item['ORIENTACION']
                }));
                
                renderTable(
                    'orientacionesPorColegioResults',
                    ['UNID EDUCATIVA', 'ORIENTACION'],
                    dataToDisplay,
                    [],
                    numeroColegio,
                    'UNID EDUCATIVA'
                );
                
                const offset = 120;
                const elementPosition = resultsContainer.getBoundingClientRect().top + window.pageYOffset;
                window.scrollTo({ top: elementPosition - offset, behavior: 'smooth' });
            } else {
                resultsContainer.innerHTML = `
                    <div class="no-results">
                        <i class="fas fa-search"></i>
                        <p>No se encontraron orientaciones para el N° de Colegio "${numeroColegio}"</p>
                    </div>
                `;
            }
            
            button.innerHTML = originalButtonText;
            button.disabled = false;
        }
        
        function filterAndDisplayExactTitle(selectedTitle) {
            const tituloInput = document.getElementById('tituloInputIntegrado');
            if (tituloInput) {
                tituloInput.value = selectedTitle;
            }

            const normalizedSelectedTitle = normalizeText(selectedTitle);

            // Filtrar datos para el título exacto
            const exactFilteredData = competenciasData.filter(item => {
                return normalizeText(item['Titulo'] || '') === normalizedSelectedTitle;
            });

            // Preparar datos para renderizar
            const dataToRender = exactFilteredData.map(item => {
                const newItem = { ...item };
                newItem['Titulo'] = highlightMatch(item['Titulo'], selectedTitle);
                return newItem;
            });

            // Renderizar tabla con resultados exactos
            renderTable(
                'incumbenciasResultsIntegrado',
                ['Titulo', 'Nombre DEL ESPACIO CURRICULAR', 'CODIGO/Modulo', 'Alcance/INCUMBENCIA'],
                dataToRender,
                ['Titulo'],
                selectedTitle,
                'Titulo',
                'Titulo'
            );

            // Actualizar select de espacios curriculares
            const selectEspacio = document.getElementById('espacioCurricularSelect');
            selectEspacio.innerHTML = '<option value="">-- Selecciona un espacio curricular --</option>';
            
            if (dataToRender.length > 0) {
                const uniqueEspaciosExact = new Set();
                dataToRender.forEach(item => {
                    if (item['Nombre DEL ESPACIO CURRICULAR']) {
                        uniqueEspaciosExact.add(item['Nombre DEL ESPACIO CURRICULAR'].trim());
                    }
                });
                
                Array.from(uniqueEspaciosExact).sort().forEach(espacio => {
                    const option = document.createElement('option');
                    option.value = espacio;
                    option.textContent = espacio;
                    selectEspacio.appendChild(option);
                });
                
                selectEspacio.disabled = false;
            } else {
                selectEspacio.disabled = true;
            }
            
            toggleBuscarColegiosButton();

            // Desplazar a los resultados
            const incumbenciasResultsContainer = document.getElementById('incumbenciasResultsIntegrado');
            if (incumbenciasResultsContainer) {
                const parentSearchGroup = incumbenciasResultsContainer.closest('.search-group');
                if (parentSearchGroup) {
                    const offset = 80;
                    const elementPosition = parentSearchGroup.getBoundingClientRect().top + window.pageYOffset;
                    window.scrollTo({ top: elementPosition - offset, behavior: 'smooth' });
                } else {
                    incumbenciasResultsContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            }
        }
        
        // =============================================
        // FUNCIONES AUXILIARES
        // =============================================
        function populateDepartamentosSelect() {
            const departamentoSelect = document.getElementById('departamentoSelect');
            departamentoSelect.innerHTML = '<option value="">-- Selecciona un departamento --</option>';

            if (!colegiosData || colegiosData.length === 0) {
                console.warn('colegiosData está vacío o no se cargó correctamente. No se pueden poblar los departamentos.');
                departamentoSelect.disabled = true;
                return;
            }

            const uniqueDepartamentos = new Set();
            colegiosData.forEach(item => {
                if (item['Departamento']) {
                    uniqueDepartamentos.add(item['Departamento'].trim());
                }
            });

            if (uniqueDepartamentos.size === 0) {
                 console.warn('No se encontraron departamentos únicos en colegiosData. La columna "Departamento" podría estar vacía o mal nombrada en tu hoja de Colegios.');
                 departamentoSelect.disabled = true;
                 return;
            }

            const sortedDepartamentos = Array.from(uniqueDepartamentos).sort();
            sortedDepartamentos.forEach(departamento => {
                const option = document.createElement('option');
                option.value = departamento;
                option.textContent = departamento;
                departamentoSelect.appendChild(option);
            });

            departamentoSelect.disabled = false;
        }
        
        function populateCategoriaDepartamentosSelect() {
            const departamentoSelect = document.getElementById('categoriaDepartamentoSelect');
            departamentoSelect.innerHTML = '<option value="">-- Todos los Departamentos --</option>';

            if (!colegiosData || colegiosData.length === 0) {
                console.warn('colegiosData está vacío o no se cargó correctamente. No se pueden poblar los departamentos para el buscador de categoría.');
                departamentoSelect.disabled = true;
                return;
            }

            const uniqueDepartamentos = new Set();
            colegiosData.forEach(item => {
                if (item['Departamento']) {
                    uniqueDepartamentos.add(item['Departamento'].trim());
                }
            });

            if (uniqueDepartamentos.size === 0) {
                console.warn('No se encontraron departamentos únicos en colegiosData para el buscador de categoría.');
                departamentoSelect.disabled = true;
                return;
            }

            const sortedDepartamentos = Array.from(uniqueDepartamentos).sort();
            sortedDepartamentos.forEach(departamento => {
                const option = document.createElement('option');
                option.value = departamento;
                option.textContent = departamento;
                departamentoSelect.appendChild(option);
            });

            departamentoSelect.disabled = false;
        }
        
        function populateCategoriaLocalidadesSelect() {
            const departamentoSelect = document.getElementById('categoriaDepartamentoSelect');
            const localidadSelect = document.getElementById('categoriaLocalidadSelect');
            const selectedDepartamento = departamentoSelect.value;

            localidadSelect.innerHTML = '<option value="">-- Todas las Localidades --</option>';
            localidadSelect.disabled = true;

            if (!selectedDepartamento) return;

            if (!colegiosData || colegiosData.length === 0) {
                console.warn('colegiosData está vacío o no se cargó correctamente. No se pueden pobrar las localidades.');
                return;
            }

            const uniqueLocalidades = new Set();
            colegiosData.filter(colegio =>
                colegio.Departamento && normalizeText(colegio.Departamento) === normalizeText(selectedDepartamento)
            ).forEach(colegio => {
                if (colegio.Localidad) {
                    uniqueLocalidades.add(colegio.Localidad.trim());
                }
            });

            if (uniqueLocalidades.size === 0) {
                console.warn(`No se encontraron localidades únicas para el departamento "${selectedDepartamento}" en colegiosData.`);
                return;
            }

            const sortedLocalidades = Array.from(uniqueLocalidades).sort();
            sortedLocalidades.forEach(localidad => {
                const option = document.createElement('option');
                option.value = localidad;
                option.textContent = localidad;
                localidadSelect.appendChild(option);
            });

            localidadSelect.disabled = false;
        }
        
        function toggleBuscarColegiosButton() {
            const selectEspacio = document.getElementById('espacioCurricularSelect');
            const selectDepartamento = document.getElementById('departamentoSelect');
            const btnBuscarColegios = document.getElementById('btnBuscarColegios');

            if (selectEspacio.value && selectDepartamento.value) {
                btnBuscarColegios.disabled = false;
            } else {
                btnBuscarColegios.disabled = true;
            }
        }
        
        function printTableResults(containerId) {
            const container = document.getElementById(containerId);
            if (!container) {
                alert('No se encontraron resultados para imprimir.');
                return;
            }

            const tableHtml = container.querySelector('table');
            if (!tableHtml) {
                alert('No hay una tabla para imprimir en este contenedor.');
                return;
            }

            let printWindow = window.open('', '', 'height=600,width=800');
            printWindow.document.write('<html><head><title>Resultados de Búsqueda</title>');
            printWindow.document.write(`
                <style>
                    body { font-family: 'Roboto', Arial, sans-serif; margin: 20px; }
                    table {
                        width: 100%;
                        border-collapse: collapse;
                        margin-top: 20px;
                        font-size: 0.9em;
                    }
                    th, td {
                        border: 1px solid #ccc;
                        padding: 8px;
                        text-align: left;
                    }
                    th {
                        background-color: #f2f2f2;
                        font-weight: bold;
                        color: #333;
                    }
                    tr:nth-child(even) {
                        background-color: #f9f9f9;
                    }
                    strong {
                        font-weight: bold;
                        color: #000;
                    }
                    .highlighted-row {
                        background-color: #e0ffe0 !important;
                        border-left: 5px solid #66bb6a !important;
                    }
                </style>
            `);
            printWindow.document.write('</head><body>');
            printWindow.document.write('<h1>Resultados de la Búsqueda</h1>');
            printWindow.document.write(tableHtml.outerHTML);
            printWindow.document.write('</body></html>');
            printWindow.document.close();

            printWindow.onload = function() {
                printWindow.print();
            };
        }
        
        function showErrorNotification(message) {
            const notification = document.createElement('div');
            notification.style.position = 'fixed';
            notification.style.bottom = '20px';
            notification.style.right = '20px';
            notification.style.backgroundColor = '#dc3545';
            notification.style.color = 'white';
            notification.style.padding = '15px';
            notification.style.borderRadius = '5px';
            notification.style.boxShadow = '0 4px 8px rgba(0,0,0,0.2)';
            notification.style.zIndex = '10000';
            notification.innerHTML = `
                <i class="fas fa-exclamation-circle" style="margin-right: 10px;"></i>
                ${message}
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.transition = 'opacity 0.5s';
                notification.style.opacity = '0';
                setTimeout(() => notification.remove(), 500);
            }, 5000);
        }
        
        // =============================================
        // CONFIGURACIÓN DE EVENT LISTENERS
        // =============================================
        function setupEventListeners() {
            // Buscador de incumbencias
            const btnBuscarIncumbencias = document.querySelector('#herramientas-consulta button[onclick="buscarIncumbenciasIntegrado(event)"]');
            if (btnBuscarIncumbencias) {
                btnBuscarIncumbencias.onclick = buscarIncumbenciasIntegrado;
            }
            
            // Buscador de colegios por espacio
            const btnBuscarColegiosPorEspacio = document.getElementById('btnBuscarColegios');
            if (btnBuscarColegiosPorEspacio) {
                btnBuscarColegiosPorEspacio.onclick = buscarColegiosAleatoriosPorEspacio;
            }
            
            // Selectores de espacio y departamento
            const selectEspacio = document.getElementById('espacioCurricularSelect');
            const selectDepartamento = document.getElementById('departamentoSelect');
            if (selectEspacio && selectDepartamento) {
                selectEspacio.addEventListener('change', toggleBuscarColegiosButton);
                selectDepartamento.addEventListener('change', toggleBuscarColegiosButton);
            }
            
            // Buscador de orientaciones
            const btnBuscarOrientaciones = document.querySelector('#herramientas-consulta button[onclick="buscarOrientaciones(event)"]');
            if (btnBuscarOrientaciones) {
                btnBuscarOrientaciones.onclick = buscarOrientaciones;
            }
            
            // Buscador de colegios por localidad
            const btnBuscarColegiosLocalidad = document.getElementById('btnBuscarColegiosLocalidad');
            if (btnBuscarColegiosLocalidad) {
                btnBuscarColegiosLocalidad.onclick = buscarColegios;
            }
            
            // Buscador por categoría
            const btnBuscarColegiosPorCategoria = document.getElementById('btnBuscarColegiosPorCategoria');
            if (btnBuscarColegiosPorCategoria) {
                btnBuscarColegiosPorCategoria.onclick = buscarColegiosPorCategoria;
            }
            
            // Selector de departamento para categoría
            const categoriaDepartamentoSelect = document.getElementById('categoriaDepartamentoSelect');
            if (categoriaDepartamentoSelect) {
                categoriaDepartamentoSelect.addEventListener('change', populateCategoriaLocalidadesSelect);
            }
            
            // Buscador de orientaciones por colegio
            const btnBuscarOrientacionesPorColegio = document.getElementById('btnBuscarOrientacionesPorColegio');
            if (btnBuscarOrientacionesPorColegio) {
                btnBuscarOrientacionesPorColegio.onclick = buscarOrientacionesPorColegio;
            }
        }
        
        // =============================================
        // INICIALIZACIÓN DE LA APLICACIÓN
        // =============================================
        document.addEventListener('DOMContentLoaded', init);
      // Carga diferida de recursos no críticos
        window.addEventListener('load', function() {
            // Carga diferida de Font Awesome
            const faLink = document.createElement('link');
            faLink.rel = 'stylesheet';
            faLink.href = 'https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css';
            document.head.appendChild(faLink);
            
            // Carga diferida de Google Fonts
            const fontLink = document.createElement('link');
            fontLink.rel = 'stylesheet';
            fontLink.href = 'https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap';
            document.head.appendChild(fontLink);
            
            // Carga diferida de iframes
            document.querySelectorAll('iframe').forEach(iframe => {
                iframe.setAttribute('loading', 'lazy');
            });
        });
        
        // Detección de navegadores problemáticos (Samsung Internet)
        if(/SamsungBrowser/i.test(navigator.userAgent)) {
            document.documentElement.classList.add('samsung-browser');
            console.log('Aplicando ajustes para Samsung Internet');
        }
                // Cerrar banner de celebración
        // Cerrar banner de notificación
        document.addEventListener('DOMContentLoaded', function() {
            const closeButton = document.querySelector('.system-notification-banner .close-banner');
            const notificationBanner = document.querySelector('.system-notification-banner');
            const container = document.querySelector('.container');
            
            if (notificationBanner) {
                // Mostrar banner solo si no está marcado como cerrado
                if (!localStorage.getItem('notificationBannerClosed')) {
                    notificationBanner.style.display = 'block';
                    container.classList.add('with-banner');
                }
                
                // Evento para cerrar el banner
                closeButton?.addEventListener('click', function() {
                    notificationBanner.style.display = 'none';
                    container.classList.remove('with-banner');
                    localStorage.setItem('notificationBannerClosed', 'true');
                });
            }
        });
    // Sistema de pestañas
        document.querySelectorAll('.tab-button').forEach(button => {
            button.addEventListener('click', function() {
                // Remover clase active de todos los botones y contenidos
                document.querySelectorAll('.tab-button, .tab-content').forEach(el => {
                    el.classList.remove('active');
                });
                
                // Agregar active al botón clickeado
                this.classList.add('active');
                
                // Mostrar el contenido correspondiente
                const tabId = this.getAttribute('data-tab');
                document.getElementById(tabId).classList.add('active');
            });
        });    
        // Cuando el DOM esté cargado
        document.addEventListener('DOMContentLoaded', function() {
            const banner = document.querySelector('.celebration-banner');
            const container = document.querySelector('.container');
            
            if (banner) {
                // Agregar clase cuando el banner existe
                container.classList.add('with-banner');
                
                // Eliminar clase cuando se cierra el banner
                document.querySelector('.close-banner')?.addEventListener('click', function() {
                    container.classList.remove('with-banner');
                    localStorage.setItem('bannerCerrado', 'true');
                });
                
                // Si estaba cerrado, quitar clase
                if (localStorage.getItem('bannerCerrado')) {
                    container.classList.remove('with-banner');
                }
            }
            // Cerrar banner de prórroga
        document.querySelector('.urgent-notification-banner .close-banner')?.addEventListener('click', function() {
            this.closest('.urgent-notification-banner').style.display = 'none';
            localStorage.setItem('extensionBannerClosed', 'true');
        });
        
        // Ocultar si ya fue cerrado
        if (localStorage.getItem('extensionBannerClosed')) {
            document.querySelector('.urgent-notification-banner').style.display = 'none';
        }
        });
        // Función para manejar la tecla ENTER en cualquier campo de búsqueda
        function setupEnterKeySearch() {
            // Selector para todos los inputs de búsqueda
            const searchInputs = document.querySelectorAll(`
                #tituloInputIntegrado,
                #orientacionInput,
                #localidadInput,
                #colegioNumeroInput,
                #categoriaColegioSelect,
                #categoriaDepartamentoSelect,
                #categoriaLocalidadSelect,
                #espacioCurricularSelect,
                #departamentoSelect
            `);
            
            searchInputs.forEach(input => {
                input.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        e.preventDefault();
                        
                        // Encontrar el botón de búsqueda asociado
                        let searchButton;
                        
                        // Casos especiales por sección
                        if (this.id === 'tituloInputIntegrado') {
                            searchButton = document.querySelector('button[onclick*="buscarIncumbenciasIntegrado"]');
                        } else if (this.id === 'orientacionInput') {
                            searchButton = document.querySelector('button[onclick*="buscarOrientaciones"]');
                        } else if (this.id === 'localidadInput') {
                            searchButton = document.querySelector('button[onclick*="buscarColegios"]');
                        } else if (this.id === 'colegioNumeroInput') {
                            searchButton = document.querySelector('button[onclick*="buscarOrientacionesPorColegio"]');
                        } else if (this.id.startsWith('categoria')) {
                            searchButton = document.querySelector('button[onclick*="buscarColegiosPorCategoria"]');
                        } else if (this.id === 'espacioCurricularSelect' || this.id === 'departamentoSelect') {
                            searchButton = document.querySelector('button[onclick*="buscarColegiosAleatoriosPorEspacio"]');
                        }
                        
                        // Si encontramos el botón, clickearlo
                        if (searchButton) {
                            searchButton.click();
                        }
                    }
                });
            });
        }
        
        // Inicializar al cargar la página
        document.addEventListener('DOMContentLoaded', function() {
            setupEnterKeySearch();
        });
    </script>    
</body>
</html>
