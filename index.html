<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Junta Calificadora de Méritos y Disciplina - Nivel Secundario</title>
    <link rel="stylesheet" href="style.css"> <style>
        /* Estilos básicos para la nueva funcionalidad */
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
            color: #333;
        }
        .container {
            width: 90%;
            max-width: 1200px;
            margin: 20px auto;
            background: #fff;
            padding: 20px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
        }
        h1, h2 {
            color: #0056b3;
            text-align: center;
        }
        .search-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: #f9f9f9;
        }
        .search-section label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
        }
        .search-section input[type="text"] {
            width: calc(100% - 22px);
            padding: 10px;
            margin-bottom: 15px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        .search-section button {
            background-color: #007bff;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        .search-section button:hover {
            background-color: #0056b3;
        }
        .results-container {
            margin-top: 20px;
            border-top: 1px solid #eee;
            padding-top: 20px;
        }
        .results-container h3 {
            color: #007bff;
            text-align: center;
        }
        .results-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        .results-table th, .results-table td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        .results-table th {
            background-color: #007bff;
            color: white;
        }
        .results-table tr:nth-child(even) {
            background-color: #f2f2f2;
        }
        .no-results {
            text-align: center;
            color: #666;
            padding: 20px;
        }
        footer {
            text-align: center;
            padding: 20px;
            background-color: #333;
            color: white;
            margin-top: 40px;
        }
    </style>
</head>
<body>
    <header>
        <nav>
            <ul>
                <li><a href="#competencias">Manual de Competencias</a></li>
                <li><a href="#orientaciones">Orientaciones de Colegios</a></li>
                <li><a href="#colegios">Colegios Secundarios</a></li>
            </ul>
        </nav>
    </header>

    <div class="container">
        <h1>Junta Calificadora de Méritos y Disciplina - Nivel Secundario</h1>
        <p>Bienvenido a la plataforma de consulta de la Junta Calificadora de Méritos y Disciplina. Aquí podrás encontrar información relevante sobre incumbencias docentes y colegios secundarios de la provincia.</p>

        <section id="competencias" class="search-section">
            <h2>Búsqueda por Título y Materias/Espacios</h2>
            <p>Ingresa tu título para conocer las materias o espacios curriculares que puedes dictar y sus incumbencias.</p>
            <label for="tituloInput">Buscar por Título o Materia/Espacio:</label>
            <input type="text" id="tituloInput" placeholder="Ej: Profesor de Lengua, Matemáticas">
            <button onclick="buscarCompetencias()">Buscar Competencias</button>
            
            <div class="results-container">
                <h3>Resultados de Competencias</h3>
                <div id="competenciasResults">
                    <p class="no-results">No hay resultados para mostrar.</p>
                </div>
            </div>
        </section>

        <section id="orientaciones" class="search-section">
            <h2>Búsqueda de Colegios por Orientación</h2>
            <p>Encuentra colegios secundarios según su orientación educativa.</p>
            <label for="orientacionInput">Buscar por Orientación:</label>
            <input type="text" id="orientacionInput" placeholder="Ej: Ciencias Naturales, Informática, Humanidades">
            <button onclick="buscarOrientaciones()">Buscar Orientaciones</button>

            <div class="results-container">
                <h3>Resultados de Orientaciones</h3>
                <div id="orientacionesResults">
                    <p class="no-results">No hay resultados para mostrar.</p>
                </div>
            </div>
        </section>

        <section id="colegios" class="search-section">
            <h2>Búsqueda de Colegios por Localidad/Departamento</h2>
            <p>Encuentra colegios secundarios ingresando una localidad o departamento.</p>
            <label for="localidadInput">Buscar por Localidad o Departamento:</label>
            <input type="text" id="localidadInput" placeholder="Ej: Salta Capital, San Ramón de la Nueva Orán">
            <button onclick="buscarColegios()">Buscar Colegios</button>

            <div class="results-container">
                <h3>Resultados de Colegios</h3>
                <div id="colegiosResults">
                    <p class="no-results">No hay resultados para mostrar.</p>
                </div>
            </div>
        </section>

    </div>

    <footer>
        <p>&copy; 2025 Junta Calificadora de Méritos y Disciplina - Nivel Secundario. Todos los derechos reservados.</p>
    </footer>

    <script>
        // URLs de tus Google Sheets publicadas como CSV
        // !!! ES CRUCIAL QUE REEMPLACES ESTAS URLs CON LAS TUYAS PUBLICADAS EN CSV !!!
        const COMPETENCIAS_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSJa52401OsVXfeO4FE-pQfG-THMCeq_jkOotepQwSmphVu9IsxBztvZ1oMWG3JRW9zFPTvL0K1ELXOz/pub?output=csv&gid=941984598'; // Reemplazar con tu URL CSV
        const ORIENTACIONES_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vS7Qnph7TWvhLYl3KhpaDVqnYLqgNGbQ7FNtdw7TNzAlskfjVTg4DePvG2MoVuZf9DD3Fc2nZ5CEOms/pub?output=csv&gid=1943513223'; // Reemplazar con tu URL CSV
        const COLEGIOS_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vStnrtyd-dwtpz4UlSU2OXrEgL79AlvRLL3c0mIPSGETpyT2sEVgaGjJOVSpryEC7Jhx4zM6HjKWZN_/pub?output=csv&gid=119647774'; // Reemplazar con tu URL CSV

        let competenciasData = [];
        let orientacionesData = [];
        let colegiosData = [];

        // Función para cargar y parsear datos CSV
        async function loadData(url) {
            try {
                const response = await fetch(url);
                const csvText = await response.text();
                return parseCSV(csvText);
            } catch (error) {
                console.error('Error cargando datos de Google Sheets (CSV):', url, error);
                alert('No se pudieron cargar los datos. Por favor, revisa las URLs de tus hojas de cálculo publicadas como CSV.');
                return [];
            }
        }

        // Función para parsear texto CSV a un array de objetos JavaScript
        // Ajustada para manejar espacios y caracteres especiales en los encabezados del CSV
        function parseCSV(csvString) {
            const lines = csvString.split('\n');
            if (lines.length < 2) return []; // No hay suficientes líneas para encabezados y datos

            // Limpia los encabezados para usarlos como claves de objeto (ej. "UNID EDUCATIVA" -> "UNID EDUCATIVA")
            // Los encabezados se mantendrán tal cual como vienen del CSV para que la búsqueda los encuentre
            const headers = lines[0].split(',').map(header => header.trim()); 
            const data = [];

            for (let i = 1; i < lines.length; i++) {
                const currentLine = lines[i].trim();
                if (currentLine === '') continue; // Saltar líneas vacías
                
                // Utiliza una expresión regular para dividir por comas pero ignorar comas dentro de comillas
                const values = currentLine.match(/(".*?"|[^",]+)(,|$)/g)
                                   .map(val => val.endsWith(',') ? val.slice(0, -1) : val) // Eliminar la coma final si existe
                                   .map(val => val.startsWith('"') && val.endsWith('"') ? val.slice(1, -1).replace(/""/g, '"') : val) // Quitar comillas y desescapar
                                   .map(val => val.trim()); // Limpiar espacios en blanco

                const row = {};
                for (let j = 0; j < headers.length; j++) {
                    row[headers[j]] = values[j] ? values[j].trim() : ''; // Asignar valor y limpiar espacios
                }
                data.push(row);
            }
            return data;
        }

        // Cargar todos los datos al cargar la página
        document.addEventListener('DOMContentLoaded', async () => {
            competenciasData = await loadData(COMPETENCIAS_URL);
            orientacionesData = await loadData(ORIENTACIONES_URL);
            colegiosData = await loadData(COLEGIOS_URL);
            console.log('Datos cargados:', { competenciasData, orientacionesData, colegiosData });
        });

        // Función para renderizar una tabla de resultados
        function renderTable(containerId, headers, data) {
            const container = document.getElementById(containerId);
            if (!container) return; // Asegurarse de que el contenedor existe

            container.innerHTML = ''; // Limpiar resultados anteriores

            if (data.length === 0) {
                container.innerHTML = '<p class="no-results">No se encontraron resultados.</p>';
                return;
            }

            const table = document.createElement('table');
            table.classList.add('results-table');

            const thead = document.createElement('thead');
            const headerRow = document.createElement('tr');
            headers.forEach(headerText => {
                const th = document.createElement('th');
                th.textContent = headerText;
                headerRow.appendChild(th);
            });
            thead.appendChild(headerRow);
            table.appendChild(thead);

            const tbody = document.createElement('tbody');
            data.forEach(item => {
                const tr = document.createElement('tr');
                headers.forEach(headerKey => {
                    const td = document.createElement('td');
                    // Usar un nombre de clave dinámico si el encabezado original tiene espacios
                    td.textContent = item[headerKey] || ''; 
                    tr.appendChild(td);
                });
                tbody.appendChild(tr);
            });
            table.appendChild(tbody);

            container.appendChild(table);
        }

        // --- FUNCIONES DE BÚSQUEDA ESPECÍFICAS ---

        function buscarCompetencias() {
            const input = document.getElementById('tituloInput').value.toLowerCase();
            if (!input) {
                // Actualizado para usar los nombres de columnas de tu CSV
                renderTable('competenciasResults', ['Nombre', 'Titulo', 'Nombre DEL ESPACIO CURRICULAR', 'Alcance/INCUMBENCIA'], []);
                return;
            }

            const filtered = competenciasData.filter(item => {
                // Ajustado para usar los nombres de encabezados exactos de tu CSV
                const titulo = item['Titulo'] ? item['Titulo'].toLowerCase() : '';
                const nombreEspacio = item['Nombre DEL ESPACIO CURRICULAR'] ? item['Nombre DEL ESPACIO CURRICULAR'].toLowerCase() : '';
                const alcance = item['Alcance/INCUMBENCIA'] ? item['Alcance/INCUMBENCIA'].toLowerCase() : '';
                const nombre = item['Nombre'] ? item['Nombre'].toLowerCase() : ''; // Añadido para búsqueda

                return titulo.includes(input) || nombreEspacio.includes(input) || alcance.includes(input) || nombre.includes(input);
            });

            // Los encabezados deben coincidir exactamente con los nombres de las columnas en tu hoja de cálculo
            renderTable('competenciasResults', ['Nombre', 'Titulo', 'Nombre DEL ESPACIO CURRICULAR', 'Alcance/INCUMBENCIA'], filtered);
        }

        function buscarOrientaciones() {
            const input = document.getElementById('orientacionInput').value.toLowerCase();
            if (!input) {
                // Actualizado para usar los nombres de columnas de tu CSV
                renderTable('orientacionesResults', ['UNID EDUCATIVA', 'ORIENTACION', 'AREA GEOGRAFICA- LOCALIDAD-DPTO'], []);
                return;
            }

            const filtered = orientacionesData.filter(item => {
                // Ajustado para usar los nombres de encabezados exactos de tu CSV
                const orientacion = item['ORIENTACION'] ? item['ORIENTACION'].toLowerCase() : '';
                const unidEducativa = item['UNID EDUCATIVA'] ? item['UNID EDUCATIVA'].toLowerCase() : '';
                const areaGeo = item['AREA GEOGRAFICA- LOCALIDAD-DPTO'] ? item['AREA GEOGRAFICA- LOCALIDAD-DPTO'].toLowerCase() : '';

                return orientacion.includes(input) || unidEducativa.includes(input) || areaGeo.includes(input);
            });

            // Los encabezados deben coincidir exactamente con los nombres de las columnas en tu hoja de cálculo
            renderTable('orientacionesResults', ['UNID EDUCATIVA', 'ORIENTACION', 'AREA GEOGRAFICA- LOCALIDAD-DPTO'], filtered);
        }

        function buscarColegios() {
            const input = document.getElementById('localidadInput').value.toLowerCase();
            if (!input) {
                // Actualizado para usar los nombres de columnas de tu CSV
                renderTable('colegiosResults', ['Nombre', 'Direccion', 'Localidad', 'Departamento', 'CodPostal'], []);
                return;
            }

            const filtered = colegiosData.filter(item => {
                // Ajustado para usar los nombres de encabezados exactos de tu CSV
                const localidad = item['Localidad'] ? item['Localidad'].toLowerCase() : '';
                const departamento = item['Departamento'] ? item['Departamento'].toLowerCase() : '';
                const direccion = item['Direccion'] ? item['Direccion'].toLowerCase() : '';
                const nombre = item['Nombre'] ? item['Nombre'].toLowerCase() : '';
                const codPostal = item['CodPostal'] ? item['CodPostal'].toLowerCase() : '';

                return localidad.includes(input) || departamento.includes(input) || direccion.includes(input) || nombre.includes(input) || codPostal.includes(input);
            });

            // Los encabezados deben coincidir exactamente con los nombres de las columnas en tu hoja de cálculo
            renderTable('colegiosResults', ['Nombre', 'Direccion', 'Localidad', 'Departamento', 'CodPostal'], filtered);
        }

    </script>
</body>
</html>
